
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">




<link
  href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"
  rel="stylesheet">

<style>
.julia {font-family: "Source Code Pro";
        color:#0033CC;
        }
body { padding-top: 60px; }
h5:before {content:"\2746\ ";}
h6:before {content:"\2742\ ";}
pre {display: block;}
</style>

<script src="http://code.jquery.com/jquery.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

<!-- .julia:before {content: "julia> "} -->

<style></style>



<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ["\$","\$"], ["\\(","\\)"]]
  },
  displayAlign: "left",
  displayIndent: "5%"
});
</script>

<script type="text/javascript">
$( document ).ready(function() {
  $("h1").each(function(index) { 
       var title = $( this ).text()
       $("#page_title").html("<strong>" + title + "</strong>");
       document.title = title
  });
  $( "h2" ).each(function( index ) {
    var nm =  $( this ).text();                                    
    var id = $.trim(nm).replace(/ /g,'');
    this.id = id
    $("#page_dropdown").append("<li><a href='#" + id + "'>" + nm + "</a></li>");
  });
  $('[data-toggle="popover"]').popover();  
});
</script>

</head>


<body data-spy="scroll" >

<nav class="navbar navbar-default  navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
         
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="#" id="page_title"></a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
         <li class="dropdown">
           <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
           Jump to... <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="page_dropdown"></ul>
        </li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<header>
</header>

<div class="container-fluid">
  <div class="span10 offset1">
<h1>Review for test 2, some answers</h1><h3>some sample problems of Ch 3</h3><ul>
<li>Will the bisection method find the zero of &#36;&#40;x-1&#41;^2&#36;?</li>
</ul><blockquote>
<p>No. The functions does not cross 0</p>
</blockquote><ul>
<li>Will Newton's method find the zero of &#36;&#40;x-1&#41;^2&#36;?</li>
</ul><blockquote>
<p>Yes, but the proofs of this we saw assume simple zeros, which &#36;r&#61;1&#36; is not.</p>
</blockquote><ul>
<li>In what ways does the function &#36;f&#40;x&#41; &#61; x^&#123;20&#125; - 1&#36; challenge the convergence of Newton's method?</li>
</ul><blockquote>
<p>Even though starting at &#36;x_0 &gt; 0&#36; is guaranteed to converge, the bound on convergence is quite large when the second derivative is large (which happens for &#36;x_n &gt;&gt; 1&#36;. And when &#36;f&#39;&#36; is close to zero which happens when &#36;x_0&#36; is less than 1.</p>
</blockquote><ul>
<li>Why do you know that using Newton's method on the function &#36;f&#40;x&#41; &#61; e^x &#43; x&#36; will be guaranteed to converge?</li>
</ul><blockquote>
<p>We know if both &#36;f&#39;&#36; and &#36;f&#39;&#39;&#36; are positive, there will be convergence.</p>
</blockquote><ul>
<li>Let &#36;f&#40;x&#41; &#61; \sin&#40;x&#41;&#36;. Starting with the &#36;x_0, x_1 &#61; 3, 4&#36;, perform 2 steps of the secant method (find &#36;x_2, x_3&#36;). How accurate is your value (&#36;f&#40;x_3&#41; - \pi&#36;)?</li>
</ul><blockquote>
<p>Let's see on the computer:</p>
</blockquote><pre class="sourceCode julia">f(x) = sin(x)
appfp(x,y) = (f(y) - f(x))/(y-x)
x0,x1 = 3//1 , 4//1
x2 = x1 - f(x1)/appfp(x1, x0)
x3 = x2 - f(x2)/appfp(x2, x1)
x0, x1, x2, x3</pre>
<pre class="output">
(3//1,4//1,3.157162792479947,3.1394590982180786)</pre>

<p>We have this error</p><pre class="sourceCode julia">err = x3 - pi</pre>
<pre class="output">
-0.0021335553717145572</pre>

<ul>
<li>The <em>efficiency index</em> is defined by &#36;\mu^&#123;1/f&#125;&#36; where &#36;\mu&#36; is the order of convergence of a method and &#36;f&#36; is the number of function calls per step. For Newton, these values are &#36;2&#36; and &#36;2&#36; and for the secant method &#36;&#40;1 &#43; \sqrt&#123;5&#125;&#41;/2&#36; and &#36;1&#36;. Which method has a bigger efficiency index?</li>
</ul><blockquote>
<p>We need to compare:</p>
</blockquote><pre class="sourceCode julia">## netwon
mu_n=2; steps_n = 2
## secant
mu_s = (1+sqrt(5))/2; steps_s = 1
mu_n^(1/steps_n), mu_s^(1/steps_s)</pre>
<pre class="output">
(1.4142135623730951,1.618033988749895)</pre>

<ul>
<li>Let &#36;e_n &#61; x_n -r&#36;, Taylor's theorem gives</li>
</ul>$$~
f(x_n) = f(r) + f'(r)e_n + (1/2) f''(r) e_n^2 + \mathcal{O}(e_n^3)
~$$<p>Divide this by &#36;e_n&#36;, then use for both the case &#36;n&#36; and &#36;n-1&#36;. Use these pieces to identify the limit as &#36;n&#36; goes to &#36;\infty&#36; of</p>$$~
\frac{f(x_n)/e_n - f(x_{n-1})/e_{n-1}}{x_n - x_{n-1}}.
~$$<blockquote>
<p>We did this in class. It is also in the book in the estimate for the error in the secant method. The limit is &#36;1/2 f&#39;&#39;&#40;r&#41;&#36;.</p>
</blockquote><ul>
<li>Let &#36;F&#40;x&#41; &#61; x/2 &#43; f&#40;x&#41;&#36; where we assume &#36;|f&#39;&#40;x&#41;| \leq 1/4&#36;. Show that &#36;F&#40;x&#41;&#36; is a contractive map.</li>
</ul><blockquote>
<p>We showed this in class:</p>
</blockquote>$$~
|F(x) - F(y)| \leq |x/2 - y/2 + f(x) - f(y)| \leq |x/2 - y/2| + |f(x) - f(y)| =
(1/2)|x-y| + |f'(\xi)||x-y| \leq (1/2 + 1/4) |x-y|.
~$$<ul>
<li>Let &#36;F&#40;x&#41; &#61; x/2 &#43; f&#40;x&#41;&#36; where we assume &#36;|f&#39;&#40;x&#41;| \leq 1/4&#36;. What is the order of convergence of the iterative mapping: &#36;x_&#123;n&#43;1&#125; &#61; F&#40;x_n&#41;&#36;?</li>
</ul><blockquote>
<p>We showed in class that &#36;F^1&#40;s&#41; \neq 0&#36;, so the order is linear.</p>
</blockquote>$$~
F'(x) = (x/2 0 f(x))' = 1/2+ f'(x) \geq 1/2 - 1/4 = 1/4 > 0.
~$$<p>So in particular, for a fixed point &#36;x&#36;, &#36;F&#39;&#40;s&#41; &gt; 0&#36;.</p><ul>
<li>Let &#36;p&gt;0&#36;. What is the value of this expression:</li>
</ul>$$~
\sqrt{p + \sqrt{p + \sqrt{p + \cdots}}}
~$$<p>(As the book says, this is &#36;x_&#123;n&#43;1&#125; &#61; \sqrt&#123;p &#43; x_n&#125;&#36;.)</p><blockquote>
<p>We saw in class for &#36;p &gt; 0&#36;, this will be when the graph of the  function &#36;F&#40;x&#41; &#61; \sqrt&#123;p &#43; x&#125;&#36; intersects the graph of the equations &#36;y&#61;x&#36;, that is a solution to &#36;x &#61; \sqrt&#123;p &#43; x&#125;&#36;. We solved this using the quadratic equation.</p>
</blockquote><h3>Some sample problems of Chapter 4</h3><ul>
<li>Show that the product of lower triangular matrices is lower triangular using the characacteriaztion that &#36;L&#36; is LT if &#36;l_&#123;ij&#125;&#61;0&#36; when &#36;j &gt; i&#36; (the column index is bigger than the row one).</li>
</ul><blockquote>
<p>Say &#36;A&#61;LM&#36; where both &#36;L&#36; and &#36;M&#36; are lower triangular. We need to show if &#36;j &gt; i&#36;, that &#36;a_&#123;ij&#125; &#61; 0&#36;. But</p>
</blockquote>$$~
a_{ij} = \sum l_{ik} m_{kj}
~$$<p>For &#36;k&gt;i&#36; we have &#36;l_&#123;ik&#125;&#61;0&#36; and for &#36;k &lt; j&#36; &#36;m_&#123;kj&#125; &#61; 0&#36;. But, as &#36;j &gt; i&#36;, this means for any &#36;k&#36; the product will be zero and hence the sum of the products will be.</p><ul>
<li>Solve for &#36;x&#36; in &#36;Ax&#61;b&#36;, when</li>
</ul>$$~
A = \left[
\begin{array}{ccc}
1 & 0 & 0\\
2 & 3 & 0\\
4 & 5 & 6
\end{array}
\right],
\quad
b = [7,8,9]^T
~$$<p>We solve by forward substitution:</p><pre class="sourceCode julia">x1 = 7/1                        # 1 x1 = 7
x2 = (8 - 2x1)/3            # 2x1 + 3x2 = 8
x3 = (9 - 4x1 - 5x2)/6  # 4x1 + 5x2 + 6x3 = 9
[x1,x2,x3]</pre>
<pre class="output">
3-element Array{Float64,1}:
  7.0
 -2.0
 -1.5</pre>

<ul>
<li>Decompose &#36;A&#36; as a product of &#36;L\cdot U&#36; using Gaussian Elimination when &#36;A&#36; is</li>
</ul>$$~
A = \left[
\begin{array}{ccc}
2 & 0 & -8\\
-4 & -1 & 0\\
7 & 4 & -5
\end{array}
\right].
~$$<p>Did you need to use a permutation matrix?</p><blockquote>
<p>We solved this in class with parital pivoting. It got a bit messier that way. Here we solve without pivoting:</p>
</blockquote><pre class="sourceCode julia">Aorig = [2//1 0 -8; -4 -1 0; 7 4 -5]
A = copy(Aorig)
L = diagm([1//1,1,1])
L[2,1] = A[2,1]/A[1,1]
A[2,:] = A[2,:] - L[2,1]*A[1,:]
L[3,1] = A[3,1] / A[1,1]
A[3,:] = A[3,:] - L[3,1]*A[1,:]
L[3,2] = A[3,2] / A[2,2]
A[3,:] = A[3,:] - L[3,2] * A[2,:]
U = A
L, U, Aorig - L*U</pre>
<pre class="output">
(
3x3 Array{Rational{Int64},2}:
  1//1   0//1  0//1
 -2//1   1//1  0//1
  7//2  -4//1  1//1,

3x3 Array{Rational{Int64},2}:
 2//1   0//1   -8//1
 0//1  -1//1  -16//1
 0//1   0//1  -41//1,

3x3 Array{Rational{Int64},2}:
 0//1  0//1  0//1
 0//1  0//1  0//1
 0//1  0//1  0//1)</pre>

<p>Use your answer to solve &#36;Ax&#61;&#91;1,2,3&#93;^T&#36;.</p><blockquote>
<p>We solve &#36;Ly&#61;b&#36; and then &#36;Ux &#61; y&#36;. First:</p>
</blockquote><pre class="sourceCode julia">b = [1,2,3]
y = L \ b</pre>
<pre class="output">
3-element Array{Rational{Int64},1}:
  1//1
  4//1
 31//2</pre>

<p>And then</p><pre class="sourceCode julia">x = U \ b</pre>
<pre class="output">
3-element Array{Rational{Int64},1}:
  17//82
 -34//41
  -3//41</pre>

<p>By hand, we need to do forward substitution to solve for &#36;y&#36; and back substitution to solve for &#36;x&#36;.</p><ul>
<li>Prove or disprove: If &#36;L&#36; and &#36;U&#36; are lower and upper triangular, then &#36;UL&#36; can not be upper triangular.</li>
</ul><blockquote>
<p>This is not true in general. Just take &#36;L&#61;I&#36;, then &#36;UL&#61;U&#36; is upper triangular.</p>
</blockquote><ul>
<li>A symmetric, positive-definite matrix satisfies the inequality: &#36;|a_&#123;ij&#125;|^2 \leq a_&#123;ii&#125; a_&#123;jj&#125;|&#36; Verify if this is the case for the symmetric matrix</li>
</ul>$$~
A = \left[
\begin{array}{cc}
1 & 2\\
2 & 1
\end{array}
\right]
~$$<blockquote>
<p>This not the case. Take &#36;i&#61;2, j&#61;1&#36;, then &#36;a_&#123;ij&#125; &#61; 2&#36; and &#36;a_&#123;22&#125; a_&#123;11&#125; &#61; 1 \cdot 1 &#61; 1&#36;.</p>
</blockquote><p>Does &#36;A&#36; have a Cholesky decomposition?</p><blockquote>
<p>No, the matrix is not symmetric positive definite.</p>
</blockquote><ul>
<li>for the matrix</li>
</ul><pre class="sourceCode julia">using SymPy
A = [ Sym(4) 1 2; 1 2 3; 2 1 2]</pre>
<div class="well well-sm">
\begin{bmatrix}4&1&2\\1&2&3\\2&1&2\end{bmatrix}</div>

<p>The LU decomposition is given by:</p><pre class="sourceCode julia">L, U, p = lu(A)</pre>
<pre class="output">
(

⎡ 1    0   0⎤
⎢           ⎥
⎢1/4   1   0⎥
⎢           ⎥
⎣1/2  2/7  1⎦,


⎡4   1    2 ⎤
⎢           ⎥
⎢0  7/4  5/2⎥
⎢           ⎥
⎣0   0   2/7⎦,

[1,2,3])</pre>

<p>From this, we have inverses:</p><pre class="sourceCode julia">inv(L)</pre>
<div class="well well-sm">
\begin{bmatrix}1&0&0\\- \frac{1}{4}&1&0\\- \frac{3}{7}&- \frac{2}{7}&1\end{bmatrix}</div>

<p>and</p><pre class="sourceCode julia">inv(U)</pre>
<div class="well well-sm">
\begin{bmatrix}\frac{1}{4}&- \frac{1}{7}&- \frac{1}{2}\\0&\frac{4}{7}&-5\\0&0&\frac{7}{2}\end{bmatrix}</div>

<p>Show that we can find &#36;A^&#123;-1&#125;&#36; using these two matrices. What is the value?</p><blockquote>
<p>We have &#36;A^&#123;-1&#125; &#61; &#40;LU&#41;^&#123;-1&#125; &#61; U^&#123;-1&#125; A^&#123;-1&#125;&#36; so we need to multiply:</p>
</blockquote><pre class="sourceCode julia">inv(U) * inv(L)</pre>
<div class="well well-sm">
\begin{bmatrix}\frac{1}{2}&0&- \frac{1}{2}\\2&2&-5\\- \frac{3}{2}&-1&\frac{7}{2}\end{bmatrix}</div>

<ul>
<li>Find &#36;\| A\|_\infty&#36; when &#36;A&#36; is the matrix</li>
</ul>$$~
A = \left[
\begin{array}{ccc}
2 & 0 & -8\\
-4 & -1 & 0\\
7 & 4 & -5
\end{array}
\right].
~$$<blockquote>
<p>This is the larger of 10, 5, and 16. So is 16.</p>
</blockquote><ul>
<li>Find the condition number of &#36;A&#36; using the &#36;l_\infty&#36; norm when &#36;A&#36; is the matrix:</li>
</ul>$$~
A = \left[
\begin{array}{ccc}
1 & 0 & 0\\
2 & 3 & 0\\
4 & 5 & 6
\end{array}
\right].
~$$<blockquote>
<p>For this we have to find &#36;\|A\| \cdot \| A^&#123;-1&#125; \|&#36;. We can tell that &#36;\|A\|&#36; is the larger of &#36;1&#36;, &#36;5&#36; or &#36;15&#36;, so is &#36;15&#36;. We have</p>
</blockquote><pre class="sourceCode julia">A = [Sym(1) 0 0; 2 3 0; 4 5 6]
inv(A)</pre>
<div class="well well-sm">
\begin{bmatrix}1&0&0\\- \frac{2}{3}&\frac{1}{3}&0\\- \frac{1}{9}&- \frac{5}{18}&\frac{1}{6}\end{bmatrix}</div>

<p>So the norm of &#36;A^&#123;-1&#125;&#36; is the larger of 1, 1, or 5/9. So is &#36;1&#36;. Hence &#36;\kappa&#40;A, \infty&#41; &#61; 15 \cdot 1 &#61; 15&#36;.</p><ul>
<li>Suppose we write &#36;A &#61; Q &#43; B&#36; where &#36;Q&#36; is invertible. Then the expression &#36;Qx^&#123;&#40;k&#43;1&#125;&#41; &#61; &#40;Q- A&#41;x^&#123;&#40;k&#41;&#125; &#43; b&#36; can be rewritten as</li>
</ul>$$~
x^{(k+1)} = Q^{-1} B x^{(k)} + Q^{-1}b.
~$$<p>This is of the general form &#36;x^&#123;&#40;k&#43;1&#41;&#125; &#61; Gx^&#123;&#40;k&#41;&#125; &#43; c&#36;. Using the criteria that the spectral radius of &#36;G&#36; must be less than 1, how does this translate to a condition on &#36;Q&#36; and &#36;B&#36; that will ensure convergence?</p><blockquote>
<p>We did this in class</p>
</blockquote><ul>
<li>Define the matrix &#36;A&#36; and vector &#36;b&#36; by</li>
</ul><pre class="sourceCode julia">A = [1 2; 3 4]</pre>
<pre class="output">
2x2 Array{Int64,2}:
 1  2
 3  4</pre>

<p>and</p><pre class="sourceCode julia">b = [1,2]</pre>
<pre class="output">
2-element Array{Int64,1}:
 1
 2</pre>

<p>A guess at an answer is &#36;x^&#123;&#40;0&#41;&#125; &#61; &#91;-1/4, 1/4&#93;&#36;. Compute the residual value &#36;r^&#123;&#40;0&#41;&#125; &#61; b - Ax^&#123;&#40;0&#41;&#125;&#36;. The error &#36;e^&#123;&#40;0&#41;&#125;&#36; satisfies &#36;Ae^&#123;&#40;0&#41;&#125; &#61; r^&#123;&#40;0&#41;&#41;&#125;&#36;. Find &#36;e^&#123;&#40;0&#41;&#125;&#36;.</p><blockquote>
<p>We can compute this directly:</p>
</blockquote><pre class="sourceCode julia">x0 = [-1/4, 1/4]
r0 = b - A*x0</pre>
<pre class="output">
2-element Array{Float64,1}:
 0.75
 1.75</pre>

<p>And solving for e0 can be done by</p><pre class="sourceCode julia">A \ r0</pre>
<pre class="output">
2-element Array{Float64,1}:
 0.25
 0.25</pre>

<ul>
<li>Let the matrix &#36;A&#36; be given by:</li>
</ul><pre class="sourceCode julia">A = [1 1/2; 1/3 1/4]</pre>
<pre class="output">
2x2 Array{Float64,2}:
 1.0       0.5 
 0.333333  0.25</pre>

<p>The Jacobi method takes &#36;Q&#36; to be the diagonal of &#36;Q&#36;. Is it guaranteed to converge for some &#36;b&#36;? (Use the &#36;\|\cdot \|_\infty&#36; norm.)</p><p>You might be interested in this computation:</p><pre class="sourceCode julia">Q = diagm(diag(A)) # [1 0; 0 1/4]
I - inv(Q) * A</pre>
<pre class="output">
2x2 Array{Float64,2}:
  0.0      -0.5
 -1.33333   0.0</pre>

<blockquote>
<p>We have that convergence is guaranteed if &#36;\|I - Q^&#123;-1&#125; A \| &lt; 1&#36;, which we see.</p>
</blockquote><ul>
<li>Prove that is &#36;A&#36; is invertible and &#36;\| B - A\| &lt; \|A^&#123;-1&#125;\|^&#123;-1&#125;&#36; then &#36;B&#36; is invertible.</li>
</ul><blockquote>
<p>This is done if we can show &#36;\| I - A^&#123;-1&#125; B\| &lt; 1&#36;. But:</p>
</blockquote>$$~
\| I - A^{-1} B\|  = \| A^{-1}A - A^{-1} B\| = \|A^{-1} (A-B)\| \leq \|A^{-1}\| \cdot \|A-B\| < \|A^{-1}\| \cdot \|A^{-1}\|^{-1}.
~$$<ul>
<li>Prove that if &#36;A&#36; is invertible, &#36;&#40;A^&#123;-1&#125;&#41;^T &#61; &#40;A^T&#41;^&#123;-1&#125;&#36;.</li>
</ul><blockquote>
<p>We show that &#36;&#40;A^&#123;-1&#125;&#41;^T&#36; is a right inverse and hence an inverse of &#36;A^T&#36; using the fact &#36;&#40;MN&#41;^T &#61; N^TM^T&#36;.</p>
</blockquote>$$~
A^T \cdot (A^{-1})^T = (A^{-1} A)^T = IT = I.
~$$<ul>
<li>Suppose &#36;A&#36; is invertible. Show that there exists an &#36;\epsilon &gt; 0&#36; such that any &#36;B&#36; satisfying \|A - B\| < \</li>
</ul><blockquote>
<p>We pick &#36;\epsilon&#36; to be &#36;&#40;1 - \|I - A\|&#41;/2&#36; where we know &#36;\|I-A\| &lt; 1&#36;, as &#36;A&#36; is invertible. Then:</p>
</blockquote>$$~
\| I - B \| = \| I - A + A - B\| \leq \|I - A\| + \|A-B\| \leq 1
~$$
  </div>
</div>  

</body>
</html>
