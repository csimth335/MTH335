
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">




<link
  href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"
  rel="stylesheet">

<style>
.julia {font-family: "Source Code Pro";
        color:#0033CC;
        }
body { padding-top: 60px; }
h5:before {content:"\2746\ ";}
h6:before {content:"\2742\ ";}
pre {display: block;}
</style>

<script src="http://code.jquery.com/jquery.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

<!-- .julia:before {content: "julia> "} -->

<style></style>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>


<!-- not TeX-AMS-MML_HTMLorMML-->
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">  
</script>
<script>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ["\$","\$"], ["\\(","\\)"]]
  },
  displayAlign: "left",
  displayIndent: "5%"
});
</script>


<script type="text/javascript">
$( document ).ready(function() {
  $("h1").each(function(index) { 
       var title = $( this ).text()
       $("#page_title").html("<strong>" + title + "</strong>");
       document.title = title
  });
  $( "h2" ).each(function( index ) {
    var nm =  $( this ).text();                                    
    var id = $.trim(nm).replace(/ /g,'');
    this.id = id
    $("#page_dropdown").append("<li><a href='#" + id + "'>" + nm + "</a></li>");
  });
  $('[data-toggle="popover"]').popover();  
});
</script>

</head>


<body data-spy="scroll" >

<nav class="navbar navbar-default  navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
         
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="#" id="page_title"></a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
         <li class="dropdown">
           <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
           Jump to... <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="page_dropdown"></ul>
        </li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<header>
</header>

<div class="container-fluid">
  <div class="span10 offset1">
<h1>Polynomial Interpolation</h1><p>The problem: we know a function's value at some points, $(x_0, y_0)$, $(x_1, y_1), \dots, (x_n, y_n)$. How can we approximate that function?</p><p>There are many functions that can go through a sequence of points, the problem is not unique in general.</p><p>However Theorem 1 on polynomial interpolation (p309)</p><blockquote>
<p>There is a <em>unique</em> polynomial of degree $n$ going through the $n+1$ points. (We assume the $x_i$ are real.)</p>
</blockquote><h2>Uniqueness</h2><p>Well, suppose there are two such polynomials $p(x)$ and $q(x)$. Then we have $h(x) = p(x) - q(x)$. It has degree at most $n$, so there are no more than $n$ roots. But $h(x_i) = p(x_i) - q(x_i) = y_i - y_i = 0$. So there are $n+1$ roots, hence a contradiction.</p><h2>Existence</h2><p>For existence, we can use induction.</p><p>For $n=0$ we just have a constant $p_0(x) = y_1$ and then $p_0(x_1) = y_1$ too.</p><p>For $n=1$: we have two points and we can make the line between them. The point slope form is helpful, it would look like:</p>$$~
p_1(x) = x_0 + \frac{y_1 - y_0}{x_1 - x_0} (x - x_0).
~$$
<hr /><p>Assuming that the statement is true for $k$, can we show it is true for $k+1$.</p><p>First from $p_{k-1}$ with degree $\leq k-1$ from the first $k-1$ points. Then we write the following formally:</p>$$~
p_k = p_{k-1}(x) + c(x-x_0)(x-x_1)\cdots (x - x_{k-1})
~$$
<p>For some $c$ we will show that this polynomial has degree $\leq k$ and $p_k(x_i) =y_i$ for all $i$ between $0$ and $k$.</p><p>The term added is an $k$th degree polynomial. So $p_k$ is a polynomial of degree $\leq k$ and degree of $p_{k-1}$.</p><p>The term added is $0$ at each of $x_0, \dots, x_{k-1}$, so for these values</p>$$~
p_k(x_i) = p_{k-1}(x_i) + 0 = y_i.
~$$
<p>Finally, $p_k(x_n) = p_{k-1}(x_k) + c \prod_{i=0}^{k-1}(x_k - x_i)$</p><p>Setting this to $y_k$ gives:</p>$$~
y_k=  p_{k-1}(x_k) + c \prod_{i=0}^{k-1}(x_k - x_i)
~$$
<p>Or</p>$$~
c = \frac{y_k - p_{k-1}(x_k)}{\prod_{i=0}^{k-1}(x_k - x_i)}.
~$$
<p>The divisor is clearly not $0$, so this defines $c$ and we have found $p_k$.</p><h3>The form of the polynomial</h3><p>We have just seen that</p>$$~
p_k(x) = c_0 + c_1(x-x_0) + c_2(x-x_0)(x-x_1) + \cdots + c_k(x-x_0)\cdots(x-x_{k-1}) =
\sum_{i=0}^{k} c_i \prod_{j=0}^{i-1} (x - x_j).
~$$
<p>where</p>$$~
c_k = \frac{y_k - p_{k-1}(x_k)}{\prod_{i=0}^{k-1}(x_k - x_i)}.
~$$
<h3>The Lagrange form of the polynomial:</h3><p>There are other means to express this polynomial, that are a bit clearer.</p><p>The Lagrange form of the interpolating polynomial uses the $y_i$ as coefficients:</p>$$~
L(x) = \sum y_i \cdot l_i(x),
~$$
<p>Where</p>$$~
l_i(x) = \prod_{m \neq i} \frac{x - x_m}{x_i - x_m}.
~$$
<p>Why this? We want a polynomial that a) takes a value of $0$ at $x_j$ ($j \neq i$) and $1$ at $x_i$. Clearly a) is satisfied by $c(x - x_0) \cdot (x - x_k)$ <strong>skipping</strong> $x_i$. Putting in $x_i$, then says $c$ should be the reciprocal of $(x_i-x_0) \cdots (x_i - x_k)$ <strong>skipping</strong> $x_i-x_i$.</p><p>These are polynomials of degree $n$. using the delta function, these satisfy:</p>$$~
l_i(x_j) = \delta_{ij}.
~$$
<p>So $L(x_i) = \sum_j y_i \delta_{ij} = y_i \cdot 1 = y_i$, as expected. So $L(x)$ is a polyonmial of degree at most $n$ and by uniqueness is the <em>interpolating</em> polynomial.</p><h3>Alternate derivations</h3><p>Suppose we have a polynomial $p_k(x) = a_0 + a_1x + a_2x^2 + \cdots a_k x^k$ which satisfies $p_k(x_i) = y_i$. Then this leads to a system of equations:</p>$$~
\begin{array}{cc}
&a_0 \cdot 1 + a_1 x_0 + a_2 x_0^2 + \cdots + a_k x_0^k = y_0\\
&a_0 \cdot 1 + a_1 x_1 + a_2 x_1^2 + \cdots + a_k x_1^k = y_1\\
&\cdots\\
&a_0 \cdot 1 + a_1 x_k + a_2 x_k^2 + \cdots + a_k x_k^k = y_k
\end{array}
~$$
<p>This is a <em>linear</em> system of $k+1$ equations in $k+1$ unknowns $a_0, a_1, \dots, a_k$. If the coefficient matrix is nonsingular, it has solution $A^{-1}y$.</p><p>For example</p><pre class="sourceCode julia">using SymPy
k=2
xs = Sym["x$i" for i in 0:k]
ys = Sym["y$i" for i in 0:k]
as = Sym["a$i" for i in 0:k]

x = symbols("x")
p = sum([as[i+1] * x^i for i in 0:k])

eqs = Sym[subs(p, x, u) - v for (u,v) in zip(xs, ys)]</pre>
<div class="well well-sm">
\begin{bmatrix}a_{0} + a_{1} x_{0} + a_{2} x_{0}^{2} - y_{0}\\a_{0} + a_{1} x_{1} + a_{2} x_{1}^{2} - y_{1}\\a_{0} + a_{1} x_{2} + a_{2} x_{2}^{2} - y_{2}\end{bmatrix}</div>

<p>We can solve these (they are linear after all):</p><pre class="sourceCode julia">us = solve(eqs, as)</pre>
<div class="well well-sm">
\begin{equation*}\begin{cases}a_{0} & \text{=>} &\frac{x_{0} x_{1} y_{2} \left(x_{0} - x_{1}\right) - x_{0} x_{2} y_{1} \left(x_{0} - x_{2}\right) + x_{1} x_{2} y_{0} \left(x_{1} - x_{2}\right)}{x_{0}^{2} x_{1} - x_{0}^{2} x_{2} - x_{0} x_{1}^{2} + x_{0} x_{2}^{2} + x_{1}^{2} x_{2} - x_{1} x_{2}^{2}}\\a_{2} & \text{=>} &\frac{y_{0} \left(x_{1} - x_{2}\right) - y_{1} \left(x_{0} - x_{2}\right) + y_{2} \left(x_{0} - x_{1}\right)}{x_{0}^{2} x_{1} - x_{0}^{2} x_{2} - x_{0} x_{1}^{2} + x_{0} x_{2}^{2} + x_{1}^{2} x_{2} - x_{1} x_{2}^{2}}\\a_{1} & \text{=>} &\frac{- y_{0} \left(x_{1}^{2} - x_{2}^{2}\right) + y_{1} \left(x_{0}^{2} - x_{2}^{2}\right) - y_{2} \left(x_{0}^{2} - x_{1}^{2}\right)}{x_{0}^{2} x_{1} - x_{0}^{2} x_{2} - x_{0} x_{1}^{2} + x_{0} x_{2}^{2} + x_{1}^{2} x_{2} - x_{1} x_{2}^{2}}\\\end{cases}\end{equation*}</div>

<p>But it isn't pretty and doesn't get prettier with factoring</p><pre class="sourceCode julia">Dict(k=>factor(v) for (k,v) in us)</pre>
<div class="well well-sm">
\begin{equation*}\begin{cases}a_{0} & \text{=>} &\frac{1}{\left(x_{0} - x_{1}\right) \left(x_{0} - x_{2}\right) \left(x_{1} - x_{2}\right)} \left(x_{0}^{2} x_{1} y_{2} - x_{0}^{2} x_{2} y_{1} - x_{0} x_{1}^{2} y_{2} + x_{0} x_{2}^{2} y_{1} + x_{1}^{2} x_{2} y_{0} - x_{1} x_{2}^{2} y_{0}\right)\\a_{2} & \text{=>} &- \frac{x_{0} y_{1} - x_{0} y_{2} - x_{1} y_{0} + x_{1} y_{2} + x_{2} y_{0} - x_{2} y_{1}}{\left(x_{0} - x_{1}\right) \left(x_{0} - x_{2}\right) \left(x_{1} - x_{2}\right)}\\a_{1} & \text{=>} &\frac{x_{0}^{2} y_{1} - x_{0}^{2} y_{2} - x_{1}^{2} y_{0} + x_{1}^{2} y_{2} + x_{2}^{2} y_{0} - x_{2}^{2} y_{1}}{\left(x_{0} - x_{1}\right) \left(x_{0} - x_{2}\right) \left(x_{1} - x_{2}\right)}\\\end{cases}\end{equation*}</div>

<h3>Vandermonde matrix</h3><p>A <a href="https://en.wikipedia.org/wiki/Vandermonde_matrix">Vandermonde</a> matrix is a matrix with a geometric progression in each row. For example, the matrix:</p>$$~
\begin{bmatrix}
1 & x_0 & x_0^2  & \cdots & x_0^k\\
1 & x_1 & x_1^2  & \cdots & x_1^k\\
  &     & \cdots &        & \\
1 & x_k & x_k^2 & \cdots & x_k^k
\end{bmatrix}
~$$
<p>Calling this $V$, then our set of equations is represented by $Va = y$. The determinant of $V$, when square, is known: $|V| = \prod_{i < j} (x_j - x_i)$.</p><p>That this is non-zero says that there will be a unique solution $a$ for a given $y$ â€“ an alternate proof of the t</p><h3>Error</h3><p>Consider $f(x) = \sin(x)$ on $[0, \pi/2]$. Then the interpolation between 2 points is just a secant line:</p><pre class="sourceCode julia">f(x) = sin(x)
a,b = pi/2 * sort(rand(2))
g(x) = f(a) + (f(b)-f(a))/(b-a)*(x-a)
plot(f, 0, pi/2)
plot!(g)
scatter!([a,b], f.([a,b]), markersize=3)

u = pi/2 * rand()
plot!([u,u], sort([f(u), g(u)]), linewidth=3)</pre>
    <div id="e6907cd5-6823-45eb-bb12-dc410b983db1" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('e6907cd5-6823-45eb-bb12-dc410b983db1');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.015339511014701464,0.15653518043614337,0.24005492356825142,0.3093338647765429,0.38275885138299665,0.4483830820525568,0.5161370180225519,0.590748224715583,0.6530897057668233,0.7043605909815007,0.7563355122164005,0.8041934085546572,0.8516024395353533,0.8910446310661762,0.9259160470831407,0.9502400551809932,0.9735169253637492,0.9888182032633145,0.9998007366681562],"type":"scatter","name":"y1","yaxis":"y","x":[0.015340112644426933,0.15718160432911563,0.24242242858978297,0.3144924606585486,0.3927807160357447,0.46495556277463396,0.5423346264010439,0.6319858600091139,0.7116572965148645,0.7815219666990599,0.857693210854355,0.9343171616249684,1.019034737503921,1.0996413732821289,1.1834535718383798,1.254005590649321,1.3401416088813418,1.4211120065657248,1.5508328626745866]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.03499973121793293,0.13046299193773492,0.18783243252748943,0.23633756441625497,0.28902773317861913,0.337603408249513,0.38968166572894636,0.4500194342205824,0.5036405222727086,0.5506613844032552,0.6019267458555528,0.653496791424849,0.7105140713309307,0.7647645744499121,0.8211725102890337,0.8686559771227674,0.9266279081013856,0.9811232330794485,1.0684289696480167],"type":"scatter","name":"y2","yaxis":"y","x":[0.030335456947418245,0.16898906748883188,0.25231410805976,0.3227643694006629,0.3992930997609362,0.4698458200669679,0.5454857927201436,0.6331221188868436,0.7110029434420451,0.7792974083075003,0.8537567071778271,0.9286585381026631,1.0114720902757113,1.090267095541802,1.172195618706738,1.2411619840694808,1.3253620991675366,1.404512690807329,1.5313180765120993]},{"showlegend":true,"mode":"markers","xaxis":"x","colorbar":{"title":""},"marker":{"symbol":"circle","color":"rgba(62, 164, 78, 1.000)","line":{"color":"rgba(0, 0, 0, 1.000)","width":1},"size":6},"y":[0.045343511986452346,0.9877552976488565],"type":"scatter","name":"y3","yaxis":"y","x":[0.04535906434768965,1.4141452938732484]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(195, 113, 210, 1.000)","shape":"linear","dash":"solid","width":3},"y":[0.20835651874307615,0.27839619645192787],"type":"scatter","name":"y4","yaxis":"y","x":[0.28212388655881,0.28212388655881]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[0.0,0.5,1.0,1.5],"ticks":"inside","tickmode":"array","domain":[0.05100612423447069,0.9934383202099737],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.0","0.5","1.0","1.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[0.0,0.5,1.0],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.0","0.5","1.0"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>Question, how big is the <em>difference</em> between the two?</p><p>Theorem 2 p315: Error in the polynomial interpolation</p><blockquote>
<p>Let $f$ be continuous of degreen $n+1$ over $[a,b]$ and $p$ be a polynomial interpolating $p$ at $n+1$ distinct points. Then for each $x$ there exists $\xi$ with 
$$ f(x) - p(x) = \frac{1}{(n+1)!} f^{(n+1)}(\xi) \prod_{i=0}^n (x - x_i). $$
</p>
</blockquote><p>PF: Let $x$ <em>not</em> be a node (otherwise it is clearly true). Then define $w$ and $\lambda$ by:</p>$$~
w(t) = \prod_0^n (t - x_i), \quad \phi(t) = f(t)  - p(t) - \lambda
w(t), \quad \phi(x) = 0
~$$
<p>Then $\lambda = (f(x) - p(x))/w(x)$. $\phi$ vanishes at $x, x_0, \dots x_n$, so by Rolle's theorem there are $n+1$ distinct zeros of $\phi'$, $n$ distinct zeros of $\phi''$, $n-1$ distinct zeros of $\phi'''$ ... So $\phi^({n+1})$ has at least one zero, $\xi$ in $(a,b)$.</p><p>But $\phi^{(n_1)} = f^{(n+1)} - p^{(n+1)} - \lambda w^{(n+1)} = f^{(n+1)} - (n+1)! \lambda. At $\xi$ this becomes:</p>$$~
0 = \phi^{(n_1)}(\xi) = f^{(n+1)}(\xi) - (n+1)! \lambda =
f^{(n+1)}(\xi) - (n+1)! (f(x) - p(x))/w(x).
~$$
<h4>Example</h4><p>For the function $f(x) = \cos(x)$ over the interval $[0, \pi/2]$ if $k=4+1$ points are chosen and a polynomial interpolates, then the difference is</p>$$~
\cos(x) - p(x) = \frac{1}{120} f^{(5)}(\xi) \prod_0^4(x-x_i)
~$$
<p>This can be as large (in absolute value) as:</p>$$~
|\cos(x) - p(x)| \leq \frac{1}{120} \cdot 1 \cdot  (\pi/2)^5 = 0.07969262624616703
~$$
<p>This is a worst case. We can graph to see the difference.</p><pre class="sourceCode julia">function dd(f,xs)
  if length(xs) == 1
     f(xs[1])
  else
	 (dd(f,xs[2:end]) - dd(f, xs[1:end-1])) / (maximum(xs) - minimum(xs))
	 end
end</pre>
<pre class="output">
dd (generic function with 1 method)</pre>

<pre class="sourceCode julia">n = 4
f(x) = cos(x)
a,b = 0, pi/2
xs = a + sort(rand(n+1)) * b

## prod_j=0^(k-1)(x-x_j)
prodk(x, k, xs) = prod([ x - xs[j+1] for j in 0:(k-1)])
## sum _(k=0)^n f[x_0, \dots x_k] prod_j=0^(k-1)(x-x_j)
p4(x) = f(xs[1]) + sum( [ dd(f, xs[1:(k+1)]) * prodk(x, k, xs) for k in 1:n])</pre>
<pre class="output">
p4 (generic function with 1 method)</pre>

<p>To visualize we try:</p><pre class="sourceCode julia">using Plots
plot(f, 0, pi/2)
plot!(p4)</pre>
    <div id="d12a14ca-f1ae-440f-90b8-fd2a4d460f1d" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('d12a14ca-f1ae-440f-90b8-fd2a4d460f1d');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.9998823427793041,0.9876723835796078,0.970759307795007,0.9509535004943236,0.9238482893245887,0.8938414913893011,0.8565060295332357,0.8068559567824899,0.7572805531778855,0.7098423471956228,0.6541839137126157,0.5943676990190855,0.524188215221818,0.4539157030200013,0.3777293657553397,0.3115185990107541,0.22861495145836855,0.14912599000546642,0.019962138107235735],"type":"scatter","name":"y1","yaxis":"y","x":[0.015340112644426933,0.15718160432911563,0.24242242858978297,0.3144924606585486,0.3927807160357447,0.46495556277463396,0.5423346264010439,0.6319858600091139,0.7116572965148645,0.7815219666990599,0.857693210854355,0.9343171616249684,1.019034737503921,1.0996413732821289,1.1834535718383798,1.254005590649321,1.3401416088813418,1.4211120065657248,1.5508328626745866]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.9995121660948707,0.9857522293284754,0.9683174497916011,0.9483274118604846,0.9212919416064601,0.8915943584755757,0.8548406172965916,0.8061660276889311,0.7577030528863616,0.7114083102655895,0.6571520965725883,0.5988866820926642,0.5305596154355727,0.4621642183489233,0.38803670469130136,0.3236445065947464,0.24308331326053823,0.16595321405517938,0.04103561112148413],"type":"scatter","name":"y2","yaxis":"y","x":[0.030335456947418245,0.16898906748883188,0.25231410805976,0.3227643694006629,0.3992930997609362,0.4698458200669679,0.5454857927201436,0.6331221188868436,0.7110029434420451,0.7792974083075003,0.8537567071778271,0.9286585381026631,1.0114720902757113,1.090267095541802,1.172195618706738,1.2411619840694808,1.3253620991675366,1.404512690807329,1.5313180765120993]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[0.5,1.0,1.5],"ticks":"inside","tickmode":"array","domain":[0.0658209390492855,0.9934383202099738],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.5","1.0","1.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[0.25,0.5,0.75],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.25","0.50","0.75"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>Not too illuminating, so we try this:</p><pre class="sourceCode julia">plot(x -> f(x) - p4(x), 0, pi/2)</pre>
    <div id="414672e4-3626-49c7-8e8c-b212aff43bac" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('414672e4-3626-49c7-8e8c-b212aff43bac');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[3.872735757759482e-5,1.6282768552366989e-6,1.7579865501882175e-5,3.3276572041551766e-5,4.369110476887261e-5,4.4045816239735025e-5,3.5241934591700996e-5,1.8388979395544958e-5,4.601128026804346e-6,-8.637202246752906e-7,4.680440775173267e-6,2.3962898627716278e-5,5.709588837421453e-5,8.703459276016012e-5,9.428209385448083e-5,8.97096891808169e-5,7.224302224723145e-5,3.7729678929288024e-5,6.14732394965678e-6,-3.494781682272796e-5,-8.695357530266734e-5,-0.0001513816319208272,-0.0002247280434568566,-0.0003119436214481519,-0.0004145804105654405,-0.0005342930017994407,-0.0006436871449449488,-0.000766121035763373,-0.0009025960562089735,-0.0010541607895065003,-0.0012219121344050482,-0.0014069964212612557,-0.001610610529664054,-0.0018340030073072423,-0.0019069419326772329,-0.001981916432286514,-0.002058965958775352],"type":"scatter","name":"y1","yaxis":"y","x":[0.015340112644426933,0.15718160432911563,0.24242242858978297,0.3144924606585486,0.3927807160357447,0.46495556277463396,0.5423346264010439,0.6319858600091139,0.7116572965148645,0.7815219666990599,0.857693210854355,0.9343171616249684,1.019034737503921,1.0996413732821289,1.1415474725602544,1.1834535718383798,1.2187295812438506,1.254005590649321,1.2755395952073263,1.2970735997653313,1.3186076043233366,1.3401416088813418,1.3603842083024376,1.3806268077235333,1.400869407144629,1.4211120065657248,1.4373271135793324,1.4535422205929402,1.469757327606548,1.4859724346201557,1.5021875416337633,1.5184026486473712,1.534617755660979,1.5508328626745866,1.5558237287046641,1.5608145947347416,1.565805460764819]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[0.5,1.0,1.5],"ticks":"inside","tickmode":"array","domain":[0.09545056867891513,0.9934383202099738],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.5","1.0","1.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[-0.002,-0.001,0.0],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-0.002","-0.001","0.000"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>So the actual difference is at most $0.002$, which is nowhere near as large as is possible ($0.079$).</p><h2>The errors can grow!</h2><p>The bound on the error depends on the derivatives of the function. For some functions, these may get big, so it isn't the case that we definitely know that $\| f -p_n \|_\infty \rightarrow 0$.</p><blockquote>
<p>p319: "The surprising state of affairs is that for most continuous functions the quantity will not converge to 0"</p>
</blockquote><p>Example, (Runge 1901). Let $f(x) = 1/(x^2+1)$ and $[a,b] = [-5,5]$. We will use <em>evenly</em> spaced points and have a look:</p><pre class="sourceCode julia">f(x) = 1/(x^2 + 1)
a,b = -5, 5


function show_n(n)
  xs = linspace(a, b, n + 1 + 2)[2:end-1]

  ip(x)  = f(xs[1]) + sum( [ dd(f, xs[1:(k+1)]) * prodk(x, k, xs) for k in 1:n])
  plot(f, a, b)
  plot!(ip)
end

show_n(2)</pre>
    <div id="fcb5cadf-7504-40ef-9cd6-d80262a7c41c" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('fcb5cadf-7504-40ef-9cd6-d80262a7c41c');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.03994734106325983,0.058841503594498704,0.07722775891986576,0.10012738830645612,0.11688743757895442,0.1379804834824026,0.16255609670765234,0.19373822950091155,0.23711603768286524,0.2946013590347598,0.336338018767323,0.385698453424391,0.44386913594351257,0.5118097036178259,0.5806363126562478,0.6566838699583735,0.7377275201593693,0.8194153544338916,0.8862519833887288,0.9424715190672456,0.9646370571976748,0.9818740374723359,0.9935974742370571,0.9993914342826798,0.9987100891194404,0.9907634979515042,0.9758934443510366,0.95471786910344,0.9280690195913227,0.8969167540705226,0.86228924290948,0.8252016170884897,0.7468530687177962,0.6685288141725143,0.5943761704914166,0.5266499051995003,0.4602718454620676,0.4027673307473901,0.35343477114982735,0.3113044713380672,0.2769793958452104,0.24744017909173877,0.22196074268695343,0.19991451993442708,0.16284719371852546,0.1347407462933523,0.11614024973403758,0.10101248995509683,0.07422668310443208,0.05754118451731878,0.040411814795740346],"type":"scatter","name":"y1","yaxis":"y","x":[-4.9023418098021185,-3.9993508283162718,-3.456690886943761,-2.997878812842343,-2.7486795562559143,-2.499480299669486,-2.2697406271616023,-2.0400009546537183,-1.7936957452944098,-1.5473905359351015,-1.4047061661049955,-1.2620217962748894,-1.1193374264447833,-0.9766530566146772,-0.8498520271834542,-0.7230509977522314,-0.5962499683210085,-0.46944893888978556,-0.3582558628167891,-0.24706278674379273,-0.1914662487072945,-0.1358697106707963,-0.0802731726342981,-0.024676634597799892,0.03593851554607441,0.09655366568994872,0.15716881583382303,0.21778396597769734,0.27839911612157164,0.33901426626544595,0.39962941640932026,0.46024456655319457,0.5821953717969262,0.7041461770406577,0.8260969822843893,0.9480477875281209,1.0828799972071013,1.2177122068860817,1.3525444165650622,1.4873766262440427,1.6156660715451405,1.7439555168462386,1.8722449621473367,2.0005344074484346,2.26731692128097,2.5340994351135055,2.758673485890978,2.983247536668451,3.531606459863641,4.047080021287085,4.872908640160599]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[-2.282693499172255,-2.2506537480977205,-2.21877112196728,-2.1870456207809363,-1.9011408100298743,-1.6286696675149355,-1.3696321932361173,-1.124028387193421,-0.8466093242753687,-0.5885965868488199,-0.38559029520189264,-0.19645659066963322,-0.006723994309535852,0.16663888170011987,0.31196191829294595,0.44337198738147937,0.5688035277647829,0.6782433557727436,0.7850429120988505,0.8703760015891506,0.9281949179743487,0.9690605703382735,0.9909445387031799,0.9997919396037676,0.9945831148183231,0.9738779146328989,0.9374148598533012,0.8852706838763666,0.8093654838421447,0.7142914774269584,0.6060348407494276,0.4804246025248308,0.3314165990694306,0.16364731425735463,0.007877638589435187,-0.16118638134251323,-0.3856178677928826,-0.6298654281814178,-0.8775344767853588,-1.1427141071361062,-1.3677645476938645,-1.604050882710861,-1.8515731121870969,-2.1103312361225695,-2.151150594895716,-2.1922360628422415,-2.2335876399621433],"type":"scatter","name":"y2","yaxis":"y","x":[-4.878475978110259,-4.854610146418399,-4.830744314726539,-4.80687848303468,-4.586204408082635,-4.36553033313059,-4.144856258178545,-3.9241821832265003,-3.6589503414225812,-3.3937184996186622,-3.1694683529282512,-2.9452182062378403,-2.7016196917301545,-2.4580211772224687,-2.2334448935167712,-2.0088686098110733,-1.768099098949299,-1.5273295880875248,-1.2483744980106466,-0.9694194079337685,-0.7215170439331089,-0.47361467993244943,-0.25622664654939004,-0.038838613166330666,0.19817269632105533,0.43518400580844135,0.673603938574862,0.9120238713412826,1.1756275950080668,1.4392313186748509,1.690043610255856,1.9408559018368612,2.201642490675229,2.4624290795135964,2.6819558386048405,2.9014825976960847,3.1694998882313272,3.4375171787665697,3.68946133692899,3.9414054950914106,4.143222534547296,4.345039574003181,4.546856613459067,4.748673652914952,4.779732399726363,4.810791146537776,4.841849893349187]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[-2.5,0.0,2.5],"ticks":"inside","tickmode":"array","domain":[0.03619130941965587,0.9934383202099738],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-2.5","0.0","2.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[-2.0,-1.0,0.0],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-2","-1","0"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<pre class="sourceCode julia">show_n(5)</pre>
    <div id="f07aa8fb-7d19-498e-aff5-aa02dac390da" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('f07aa8fb-7d19-498e-aff5-aa02dac390da');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.03994734106325983,0.058841503594498704,0.07722775891986576,0.10012738830645612,0.11688743757895442,0.1379804834824026,0.16255609670765234,0.19373822950091155,0.23711603768286524,0.2946013590347598,0.336338018767323,0.385698453424391,0.44386913594351257,0.5118097036178259,0.5806363126562478,0.6566838699583735,0.7377275201593693,0.8194153544338916,0.8862519833887288,0.9424715190672456,0.9646370571976748,0.9818740374723359,0.9935974742370571,0.9993914342826798,0.9987100891194404,0.9907634979515042,0.9758934443510366,0.95471786910344,0.9280690195913227,0.8969167540705226,0.86228924290948,0.8252016170884897,0.7468530687177962,0.6685288141725143,0.5943761704914166,0.5266499051995003,0.4602718454620676,0.4027673307473901,0.35343477114982735,0.3113044713380672,0.2769793958452104,0.24744017909173877,0.22196074268695343,0.19991451993442708,0.16284719371852546,0.1347407462933523,0.11614024973403758,0.10101248995509683,0.07422668310443208,0.05754118451731878,0.040411814795740346],"type":"scatter","name":"y1","yaxis":"y","x":[-4.9023418098021185,-3.9993508283162718,-3.456690886943761,-2.997878812842343,-2.7486795562559143,-2.499480299669486,-2.2697406271616023,-2.0400009546537183,-1.7936957452944098,-1.5473905359351015,-1.4047061661049955,-1.2620217962748894,-1.1193374264447833,-0.9766530566146772,-0.8498520271834542,-0.7230509977522314,-0.5962499683210085,-0.46944893888978556,-0.3582558628167891,-0.24706278674379273,-0.1914662487072945,-0.1358697106707963,-0.0802731726342981,-0.024676634597799892,0.03593851554607441,0.09655366568994872,0.15716881583382303,0.21778396597769734,0.27839911612157164,0.33901426626544595,0.39962941640932026,0.46024456655319457,0.5821953717969262,0.7041461770406577,0.8260969822843893,0.9480477875281209,1.0828799972071013,1.2177122068860817,1.3525444165650622,1.4873766262440427,1.6156660715451405,1.7439555168462386,1.8722449621473367,2.0005344074484346,2.26731692128097,2.5340994351135055,2.758673485890978,2.983247536668451,3.531606459863641,4.047080021287085,4.872908640160599]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[1.7553774852839954,1.6983656921122514,1.6425556967510975,1.5879338981470903,1.3504635600290134,1.1367843322995745,0.9456080611421586,0.7756772153766337,0.6257648864593593,0.49467478848318036,0.3812412581774288,0.2843292549079241,0.23357504601633627,0.18815377215818324,0.14783504844648881,0.11239248410391234,0.05525024096492845,0.014995798715217737,-0.007099131778935383,-0.01928691083960768,-0.022506973449560833,-0.017666098194842092,-0.004291529838576835,0.016487295529005956,0.04363905053063643,0.07617787893113272,0.14717059484259232,0.2278221236483588,0.3193822688888226,0.4109003673294789,0.5106608029881853,0.5977885393102352,0.6605687743892977,0.706765882652595,0.7321262821830711,0.7425021909864707,0.7363848952571846,0.7123112949733914,0.6708595498968553,0.613671997766433,0.534823419685162,0.44341847937944023,0.34930010971065006,0.25338729114812875,0.15812511932720552,0.07491722133161215,0.04552875539295852,0.020465802836122968,0.0004461613310792062,-0.013782380712075062,-0.02216817303711495,-0.019284787019426722,-0.0035895743673667463,0.026526746088435624,0.0694834827014038,0.12810967771690474,0.20390316938757158,0.2984138260457533,0.388699323805319,0.4928692720702911,0.6117925471683666,0.7463594478528967,0.89748169530287,1.0660924331229258,1.2531462273433491,1.4596190664200788,1.527231763632431,1.5968079600376819,1.6683773395664674],"type":"scatter","name":"y2","yaxis":"y","x":[-4.878475978110259,-4.854610146418399,-4.830744314726539,-4.80687848303468,-4.696541445558657,-4.586204408082635,-4.475867370606613,-4.36553033313059,-4.255193295654568,-4.144856258178545,-4.0345192207025224,-3.9241821832265003,-3.8578742227755205,-3.7915662623245407,-3.725258301873561,-3.6589503414225812,-3.5263344205206217,-3.3937184996186622,-3.2815934262734565,-3.1694683529282512,-3.057343279583046,-2.9452182062378403,-2.8234189489839974,-2.7016196917301545,-2.5798204344763116,-2.4580211772224687,-2.2334448935167712,-2.0088686098110733,-1.768099098949299,-1.5273295880875248,-1.2483744980106466,-0.9694194079337685,-0.7215170439331089,-0.47361467993244943,-0.25622664654939004,-0.038838613166330666,0.19817269632105533,0.43518400580844135,0.673603938574862,0.9120238713412826,1.1756275950080668,1.4392313186748509,1.690043610255856,1.9408559018368612,2.201642490675229,2.4624290795135964,2.5721924590592185,2.6819558386048405,2.7917192181504626,2.9014825976960847,3.035491242963706,3.1694998882313272,3.3035085334989485,3.4375171787665697,3.56348925784778,3.68946133692899,3.8154334160102,3.9414054950914106,4.042314014819353,4.143222534547296,4.244131054275238,4.345039574003181,4.445948093731124,4.546856613459067,4.64776513318701,4.748673652914952,4.779732399726363,4.810791146537776,4.841849893349187]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[-2.5,0.0,2.5],"ticks":"inside","tickmode":"array","domain":[0.05100612423447069,0.9934383202099737],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-2.5","0.0","2.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[0.0,0.5,1.0,1.5],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.0","0.5","1.0","1.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<pre class="sourceCode julia">show_n(7)</pre>
    <div id="2d77c617-c626-4b20-a4b6-28fce33355bc" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('2d77c617-c626-4b20-a4b6-28fce33355bc');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.03994734106325983,0.058841503594498704,0.07722775891986576,0.10012738830645612,0.11688743757895442,0.1379804834824026,0.16255609670765234,0.19373822950091155,0.23711603768286524,0.2946013590347598,0.336338018767323,0.385698453424391,0.44386913594351257,0.5118097036178259,0.5806363126562478,0.6566838699583735,0.7377275201593693,0.8194153544338916,0.8862519833887288,0.9424715190672456,0.9646370571976748,0.9818740374723359,0.9935974742370571,0.9993914342826798,0.9987100891194404,0.9907634979515042,0.9758934443510366,0.95471786910344,0.9280690195913227,0.8969167540705226,0.86228924290948,0.8252016170884897,0.7468530687177962,0.6685288141725143,0.5943761704914166,0.5266499051995003,0.4602718454620676,0.4027673307473901,0.35343477114982735,0.3113044713380672,0.2769793958452104,0.24744017909173877,0.22196074268695343,0.19991451993442708,0.16284719371852546,0.1347407462933523,0.11614024973403758,0.10101248995509683,0.07422668310443208,0.05754118451731878,0.040411814795740346],"type":"scatter","name":"y1","yaxis":"y","x":[-4.9023418098021185,-3.9993508283162718,-3.456690886943761,-2.997878812842343,-2.7486795562559143,-2.499480299669486,-2.2697406271616023,-2.0400009546537183,-1.7936957452944098,-1.5473905359351015,-1.4047061661049955,-1.2620217962748894,-1.1193374264447833,-0.9766530566146772,-0.8498520271834542,-0.7230509977522314,-0.5962499683210085,-0.46944893888978556,-0.3582558628167891,-0.24706278674379273,-0.1914662487072945,-0.1358697106707963,-0.0802731726342981,-0.024676634597799892,0.03593851554607441,0.09655366568994872,0.15716881583382303,0.21778396597769734,0.27839911612157164,0.33901426626544595,0.39962941640932026,0.46024456655319457,0.5821953717969262,0.7041461770406577,0.8260969822843893,0.9480477875281209,1.0828799972071013,1.2177122068860817,1.3525444165650622,1.4873766262440427,1.6156660715451405,1.7439555168462386,1.8722449621473367,2.0005344074484346,2.26731692128097,2.5340994351135055,2.758673485890978,2.983247536668451,3.531606459863641,4.047080021287085,4.872908640160599]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[-4.066067395120404,-3.959058220916823,-3.854043803121613,-3.750997892113998,-3.6498944682395367,-3.55070774059138,-3.4534121457945366,-3.3579823467930416,-2.9403272733255625,-2.559603537900748,-2.2134910071523213,-1.8997668103828769,-1.6163028668497432,-1.361063442268523,-1.1321027345342616,-0.9275624886602771,-0.7456696409346548,-0.5847339922943775,-0.4431459109171154,-0.31937406403068036,-0.21196317894012853,-0.11953183327251213,-0.040770274439286186,0.02556173168362362,0.09049148828204821,0.14106821454573618,0.17907274997427008,0.20615989858320463,0.2336009417358231,0.23429658466000386,0.19961410819042658,0.14872186271402826,0.1026029025964349,0.08385069521621392,0.09825369362895428,0.14390827566136993,0.22349948576597498,0.3268418103904337,0.4624754368830333,0.5982534850573957,0.7052227374534601,0.7885284232439329,0.8358526105262297,0.8555330337891189,0.8439079122221281,0.7987814536200879,0.7234499187266801,0.6246182118906279,0.3685773021080405,0.1634563285580298,0.10286144462104582,0.08388424703063732,0.09990236188156906,0.13910407370732011,0.19962080153209058,0.236425211874242,0.22904616179665524,0.19495145768385555,0.1649010654108458,0.12440188533064564,0.0719945445731571,0.006115576589011268,-0.1317327825857977,-0.3159651817974283,-0.42802520283031353,-0.554842564284397,-0.6975792942205683,-0.8574518794556714,-1.0357327121648556,-1.2337515535796701,-1.4528970147817557,-1.6946180545919713,-1.9604254945553887,-2.251893551021625,-2.5706613843210007,-2.9184346650361177,-3.1477071449528835,-3.3890686185416583,-3.6429560757358614],"type":"scatter","name":"y2","yaxis":"y","x":[-4.890408893956189,-4.878475978110259,-4.866543062264329,-4.854610146418399,-4.84267723057247,-4.830744314726539,-4.81881139888061,-4.80687848303468,-4.751709964296669,-4.696541445558657,-4.641372926820646,-4.586204408082635,-4.531035889344624,-4.475867370606613,-4.420698851868602,-4.36553033313059,-4.310361814392579,-4.255193295654568,-4.200024776916557,-4.144856258178545,-4.089687739440533,-4.0345192207025224,-3.9793507019645116,-3.9241821832265003,-3.8578742227755205,-3.7915662623245407,-3.725258301873561,-3.6589503414225812,-3.5263344205206217,-3.3937184996186622,-3.1694683529282512,-2.9452182062378403,-2.7016196917301545,-2.4580211772224687,-2.2334448935167712,-2.0088686098110733,-1.768099098949299,-1.5273295880875248,-1.2483744980106466,-0.9694194079337685,-0.7215170439331089,-0.47361467993244943,-0.25622664654939004,-0.038838613166330666,0.19817269632105533,0.43518400580844135,0.673603938574862,0.9120238713412826,1.4392313186748509,1.9408559018368612,2.201642490675229,2.4624290795135964,2.6819558386048405,2.9014825976960847,3.1694998882313272,3.4375171787665697,3.56348925784778,3.68946133692899,3.752447376469595,3.8154334160102,3.878419455550805,3.9414054950914106,4.042314014819353,4.143222534547296,4.193676794411267,4.244131054275238,4.294585314139209,4.345039574003181,4.395493833867152,4.445948093731124,4.496402353595095,4.546856613459067,4.597310873323038,4.64776513318701,4.69821939305098,4.748673652914952,4.779732399726363,4.810791146537776,4.841849893349187]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[-2.5,0.0,2.5],"ticks":"inside","tickmode":"array","domain":[0.03619130941965587,0.9934383202099738],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-2.5","0.0","2.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[-4.0,-3.0,-2.0,-1.0,0.0],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-4","-3","-2","-1","0"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<pre class="sourceCode julia">show_n(15)</pre>
    <div id="785dea5c-0627-48ed-b579-a5ebea962757" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('785dea5c-0627-48ed-b579-a5ebea962757');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.03994734106325983,0.058841503594498704,0.07722775891986576,0.10012738830645612,0.11688743757895442,0.1379804834824026,0.16255609670765234,0.19373822950091155,0.23711603768286524,0.2946013590347598,0.336338018767323,0.385698453424391,0.44386913594351257,0.5118097036178259,0.5806363126562478,0.6566838699583735,0.7377275201593693,0.8194153544338916,0.8862519833887288,0.9424715190672456,0.9646370571976748,0.9818740374723359,0.9935974742370571,0.9993914342826798,0.9987100891194404,0.9907634979515042,0.9758934443510366,0.95471786910344,0.9280690195913227,0.8969167540705226,0.86228924290948,0.8252016170884897,0.7468530687177962,0.6685288141725143,0.5943761704914166,0.5266499051995003,0.4602718454620676,0.4027673307473901,0.35343477114982735,0.3113044713380672,0.2769793958452104,0.24744017909173877,0.22196074268695343,0.19991451993442708,0.16284719371852546,0.1347407462933523,0.11614024973403758,0.10101248995509683,0.07422668310443208,0.05754118451731878,0.040411814795740346],"type":"scatter","name":"y1","yaxis":"y","x":[-4.9023418098021185,-3.9993508283162718,-3.456690886943761,-2.997878812842343,-2.7486795562559143,-2.499480299669486,-2.2697406271616023,-2.0400009546537183,-1.7936957452944098,-1.5473905359351015,-1.4047061661049955,-1.2620217962748894,-1.1193374264447833,-0.9766530566146772,-0.8498520271834542,-0.7230509977522314,-0.5962499683210085,-0.46944893888978556,-0.3582558628167891,-0.24706278674379273,-0.1914662487072945,-0.1358697106707963,-0.0802731726342981,-0.024676634597799892,0.03593851554607441,0.09655366568994872,0.15716881583382303,0.21778396597769734,0.27839911612157164,0.33901426626544595,0.39962941640932026,0.46024456655319457,0.5821953717969262,0.7041461770406577,0.8260969822843893,0.9480477875281209,1.0828799972071013,1.2177122068860817,1.3525444165650622,1.4873766262440427,1.6156660715451405,1.7439555168462386,1.8722449621473367,2.0005344074484346,2.26731692128097,2.5340994351135055,2.758673485890978,2.983247536668451,3.531606459863641,4.047080021287085,4.872908640160599]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[-94.85563560362797,-88.32035905531741,-82.15923306388054,-76.35414653443586,-70.88773516145378,-65.74335515261637,-63.28691645141751,-60.90505773953869,-58.59588996246916,-56.35756445542652,-46.87923438229787,-38.70955193108488,-31.696569202992432,-25.70332896184344,-20.60660401251637,-16.295726775533307,-12.671503600691736,-9.645208638866011,-7.137652355827701,-5.078320025535978,-3.404575783199972,-2.060928050882578,-0.17366789467453178,0.9089264635525156,1.595608405020403,1.328679968736131,0.8052830681577869,0.34257355890133745,-0.10817789934813393,-0.0030878597787261097,0.11299744644638905,0.1446791155380367,0.12571591523022735,0.2018164000344331,0.30294653104904723,0.5110638215264758,0.8267263376094758,0.9850882474414058,0.8492163415892582,0.5443171113841776,0.3239955945831815,0.21665276363200223,0.12543534167234952,0.1434267281216676,0.11298704727606854,-0.03138886525515436,-0.09769364905458208,0.4049160800782712,0.8424684243169818,1.3216535208174403,1.5963514827721976,1.1583411429498849,0.4041695233605562,-0.9198909106108974,-3.03185990600492,-6.208431230674032,-8.301392526422214,-10.797076840990494,-13.752286991564924,-17.230130050996202,-21.300584206929905,-26.04110741056798,-31.537290346281004,-37.88355637906103,-40.02380318129804,-42.257586950838466,-44.58822829378392,-47.01914561952095,-52.195985393986355,-57.81750251817699,-63.9148177100467,-70.52086076190314,-77.67045861809972],"type":"scatter","name":"y2","yaxis":"y","x":[-4.890408893956189,-4.878475978110259,-4.866543062264329,-4.854610146418399,-4.84267723057247,-4.830744314726539,-4.824777856803575,-4.81881139888061,-4.812844940957644,-4.80687848303468,-4.779294223665675,-4.751709964296669,-4.724125704927664,-4.696541445558657,-4.668957186189651,-4.641372926820646,-4.61378866745164,-4.586204408082635,-4.558620148713629,-4.531035889344624,-4.503451629975618,-4.475867370606613,-4.420698851868602,-4.36553033313059,-4.255193295654568,-4.144856258178545,-4.0345192207025224,-3.9241821832265003,-3.6589503414225812,-3.3937184996186622,-3.1694683529282512,-2.9452182062378403,-2.4580211772224687,-2.0088686098110733,-1.5273295880875248,-0.9694194079337685,-0.47361467993244943,-0.038838613166330666,0.43518400580844135,0.9120238713412826,1.4392313186748509,1.9408559018368612,2.4624290795135964,2.9014825976960847,3.1694998882313272,3.4375171787665697,3.68946133692899,3.9414054950914106,4.042314014819353,4.143222534547296,4.244131054275238,4.345039574003181,4.395493833867152,4.445948093731124,4.496402353595095,4.546856613459067,4.572083743391053,4.597310873323038,4.622538003255023,4.64776513318701,4.672992263118995,4.69821939305098,4.723446522982966,4.748673652914952,4.756438339617805,4.764203026320658,4.7719677130235105,4.779732399726363,4.7952617731320695,4.810791146537776,4.826320519943481,4.841849893349187,4.857379266754894]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[-2.5,0.0,2.5],"ticks":"inside","tickmode":"array","domain":[0.05100612423447069,0.9934383202099737],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-2.5","0.0","2.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[-80.0,-60.0,-40.0,-20.0,0.0],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-80","-60","-40","-20","0"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>(There are better functions to approximate over an entire interval.)</p><h3>Divided differences 6.2</h3><p>Suppose we have $y_i = f(x_i)$ and we want to find the interpolating polynomial. We can express this in terms of $f$.</p><p>Following the book (p328), we define</p>$$~
q_0(x) = 1, \quad q_1(x) = (x - x_0), \quad q_2(x) = (x - x_0)(x-x_1),
...
~$$
<p>Then we have seen for some $c_k$ that $p(x) = \sum_{j=0}^n c_j q_j(x)$</p><p>For $n=2$, from $p(x_i) = f(x_i)$, we see that the $c_i$s satisfy $Lc=f$ where $c = [c_0, c_1, c_2]$ and $f=[f(x_0), f(x_1), f(x_2)$ and $L$ is lower triangular</p>$$~
\begin{bmatrix}
1 & 0 & 0 \\
1 & (x_1-x_0) & 0 \\
1 & (x_2-x_0) & (x_2-x_0)\cdot (x_2 - x_1)
\end{bmatrix}.
~$$
<p>We see that $c_m$ depends on $f(x_0), f(x_1), \dots, f(x_m)$ only and not $f(x_j)$ with $j > m$. The book writes $f[x_0, x_1, \dots, x_m] = c_m$. This defines the notation with square brackets called divided differences.</p><p>Notice:</p><ul>
<li><p>From $1 \cdot c_0 = f(x_0)$ that $f[x_0] = f(x_0)$.</p>
</li>
<li><p>From $f(x_1) = f[x_1] = 1 \cdot c_0  + (x_1-x_0) c_1 = f[x_0] + (x_1 - x_0) f[x_0, x_1]$ that we can solve $f[x_0, x_1] = (f[x_1] -f[x_0])/(x_1 - x_0)$.</p>
</li>
</ul><h3>Thm 1 p330</h3><p>The following recursive formula holds:</p>$$~
f[x_0, x_1, \cdots, x_n] = \frac{f[x_1, \cdots, x_n] -
f[x_0, x_1, \cdots, x_{n-1}]}{x_n - x_0}.
~$$
<p>PF: Let $p_k$ interpolate $f$ at $x_0, x_1, \dots, x_k$ and $q$ interpolate $f$ at $x_1, \dots, x_n$. Then</p>$$~
p_n(x) = q(x) + \frac{x - x_n}{x_n-x_0} \cdot (q(x)  - p_{n-1}(x). (Why?)
~$$
<p>What is coefficient of $x^n$? The left and right side must be the same. On left hand side it is $f[x_0, \dots x_n]$. On right hand side it is</p>$$~
\frac{1}{x_n-x_0}(f[x_1, \dots, x_n] - f[x_0, \dots, x_{n-1}]).
~$$
<h3>Properties:</h3><blockquote>
<p>Thm 2 p333: can permute $x_i$s.  Sure, by uniqueness of polynomial coefficients.</p>
</blockquote><blockquote>
<p>Thm 3 p333: Let $p$ be a polynomial that interpolates $f$ and $t$ some other point then</p>
</blockquote>$$~
f(t) - p(t) = f[x_0, x_1, \dots, x_n, t] \cdot \prod (t-x_j)
~$$
<p>Why? If $q(x)$ interpolates $f(x)$ at the points <em>and</em> $t$, then $q(t) = f(t)$ and</p>$$~
q(x) = p(x) +  f[x_0, x_1, \dots, x_n, t] \cdot \prod (x - x_j)
~$$
<blockquote>
<p>Thm 4 p333: Divided differences look like <em>derivatives</em>. If $f$ has sufficient derivatives, then if $a < x_0 < x_1 < \dots x_n < b$ there exists $\xi$ in $(a,b)$ with</p>
</blockquote>$$~
f[x_0, x_1, \dots, x_n] = \frac{1}{n!}f^{(n)}(\xi).
~$$
<p>This is the error bound theorem in disguise.</p><h3>Relate to Taylor polynomial</h3><p>In calculus, we have that the tangent line is the limit of the secant line. Here we can view it as the limit of the newton interpolating polynomial between $x_0$ and $x_1$ as $x_1 \rightarrow x_0$:</p><pre class="sourceCode julia">function div_differences(f, xs) 
  if length(xs) == 1
    return f(xs[1])
  else
    return (div_differences(f, xs[2:end]) - div_differences(f,xs[1:end-1]))/(xs[end] - xs[1])
  end
end</pre>
<pre class="output">
div_differences (generic function with 1 method)</pre>

<p>And then if we skin it:</p><pre class="sourceCode julia">Base.getindex(f::T, xs...) where {T <: Function} = div_differences(f, [xs...])
Base.getindex(f::T, xs...) where {T <: SymFunction} = div_differences(f, [xs...])</pre>
<pre class="sourceCode julia">using SymPy
@vars x x0 x1
f(x) = sin(x)
p = f[x0] + f[x0, x1]*(x-x0)</pre>
<div class="well well-sm">
$$\frac{1}{- x_{0} + x_{1}} \left(x - x_{0}\right) \left(- \sin{\left (x_{0} \right )} + \sin{\left (x_{1} \right )}\right) + \sin{\left (x_{0} \right )}$$</div>

<p>And taking a limit:</p><pre class="sourceCode julia">limit(p, x1 => x0)</pre>
<div class="well well-sm">
$$x \cos{\left (x_{0} \right )} - x_{0} \cos{\left (x_{0} \right )} + \sin{\left (x_{0} \right )}$$</div>

<p>Or with a symbolic function</p><pre class="sourceCode julia">u = SymFunction("u")
p = u[x0] + u[x0, x1]*(x-x0)</pre>
<div class="well well-sm">
$$\frac{1}{- x_{0} + x_{1}} \left(x - x_{0}\right) \left(- u{\left (x_{0} \right )} + u{\left (x_{1} \right )}\right) + u{\left (x_{0} \right )}$$</div>

<pre class="sourceCode julia">limit(p, x1 => x0)  # this is u(x_0) + u'(x_0) * (x - x_0)</pre>
<div class="well well-sm">
$$x \left. \frac{d}{d \xi_{1}} u{\left (\xi_{1} \right )} \right|_{\substack{ \xi_{1}=x_{0} }} - x_{0} \left. \frac{d}{d \xi_{1}} u{\left (\xi_{1} \right )} \right|_{\substack{ \xi_{1}=x_{0} }} + u{\left (x_{0} \right )}$$</div>

<p>More generally, we can take more points:</p><pre class="sourceCode julia">@vars x h x0
x1 = x0+h; x2=x0+2h; x3=x0+3h
p = u[x0] + u[x0, x1]*(x-x0) + u[x0, x1, x2]*(x-x0)*(x-x1)+u[x0, x1,x2,x3]*(x-x0) *(x-x1)*(x-x2)</pre>
<div class="well well-sm">
$$u{\left (x_{0} \right )} + \frac{1}{3 h} \left(x - x_{0}\right) \left(- \frac{1}{2 h} \left(- \frac{1}{h} \left(- u{\left (x_{0} \right )} + u{\left (h + x_{0} \right )}\right) + \frac{1}{h} \left(- u{\left (h + x_{0} \right )} + u{\left (2 h + x_{0} \right )}\right)\right) + \frac{1}{2 h} \left(- \frac{1}{h} \left(- u{\left (h + x_{0} \right )} + u{\left (2 h + x_{0} \right )}\right) + \frac{1}{h} \left(- u{\left (2 h + x_{0} \right )} + u{\left (3 h + x_{0} \right )}\right)\right)\right) \left(- 2 h + x - x_{0}\right) \left(- h + x - x_{0}\right) + \frac{1}{2 h} \left(x - x_{0}\right) \left(- \frac{1}{h} \left(- u{\left (x_{0} \right )} + u{\left (h + x_{0} \right )}\right) + \frac{1}{h} \left(- u{\left (h + x_{0} \right )} + u{\left (2 h + x_{0} \right )}\right)\right) \left(- h + x - x_{0}\right) + \frac{1}{h} \left(x - x_{0}\right) \left(- u{\left (x_{0} \right )} + u{\left (h + x_{0} \right )}\right)$$</div>

<pre class="sourceCode julia">limit(p, h=>0)(x0 => 0)  # u(0) + u'(0)x + (1/2) * u''(0)x^2 + (1/6) * u'''(0)x^3</pre>
<div class="well well-sm">
$$\frac{x^{3}}{6} \left. \frac{d^{3}}{d \xi_{1}^{3}}  u{\left (\xi_{1} \right )} \right|_{\substack{ \xi_{1}=0 }} + \frac{x^{2}}{2} \left. \frac{d^{2}}{d \xi_{1}^{2}}  u{\left (\xi_{1} \right )} \right|_{\substack{ \xi_{1}=0 }} + x \left. \frac{d}{d \xi_{1}} u{\left (\xi_{1} \right )} \right|_{\substack{ \xi_{1}=0 }} + u{\left (0 \right )}$$</div>


  </div>
</div>  

</body>
</html>
