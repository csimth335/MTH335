
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">




<link
  href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"
  rel="stylesheet">

<style>
.julia {font-family: "Source Code Pro";
        color:#0033CC;
        }
body { padding-top: 60px; }
h5:before {content:"\2746\ ";}
h6:before {content:"\2742\ ";}
pre {display: block;}
</style>

<script src="http://code.jquery.com/jquery.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

<!-- .julia:before {content: "julia> "} -->

<style></style>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>


<!-- not TeX-AMS-MML_HTMLorMML-->
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">  
</script>
<script>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ["\$","\$"], ["\\(","\\)"]]
  },
  displayAlign: "left",
  displayIndent: "5%"
});
</script>


<script type="text/javascript">
$( document ).ready(function() {
  $("h1").each(function(index) { 
       var title = $( this ).text()
       $("#page_title").html("<strong>" + title + "</strong>");
       document.title = title
  });
  $( "h2" ).each(function( index ) {
    var nm =  $( this ).text();                                    
    var id = $.trim(nm).replace(/ /g,'');
    this.id = id
    $("#page_dropdown").append("<li><a href='#" + id + "'>" + nm + "</a></li>");
  });
  $('[data-toggle="popover"]').popover();  
});
</script>

</head>


<body data-spy="scroll" >

<nav class="navbar navbar-default  navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
         
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li><a href="#" id="page_title"></a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
         <li class="dropdown">
           <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
           Jump to... <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="page_dropdown"></ul>
        </li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<header>
</header>

<div class="container-fluid">
  <div class="span10 offset1">
<h1>Polynomial Approximation</h1><p>How well can we <em>approximate</em> a function with a polynomial?</p><p>The Taylor polynomial is the best approximation near a point $x=c$, but what polynomial is the "best" approximation over an entire interval $[a,b]$?</p><p>Here "best" <em>might</em> mean which $p$ has the smallest value of $max_{[a,b]} | f(x) - p(x) |$. This is the infinity-norm between two functions.</p><p>What do we know:</p><blockquote>
<p>Theorem 2 p315: Error in the polynomial interpolation Let $f$ be continuous of degreen $n+1$ over $[a,b]$ and $p$ be a polynomial interpolating $p$ at $n+1$ distinct points. Then for each $x$ there exists $\xi$ with 
$$ f(x) - p(x) = \frac{1}{(n+1)!} f^{(n+1)}(\xi) \prod_{i=0}^n (x - x_i). $$
</p>
</blockquote><h4>Example</h4><p>We can visualize this a bit: Consider $f(x) = \sin(x)$ on $[0, \pi/2]$. Then the interpolation between 2 points is just a secant line:</p><pre class="sourceCode julia">f(x) = sin(x)
a,b = pi/2 * sort(rand(2))
g(x) = f(a) + (f(b)-f(a))/(b-a)*(x-a)
plot(f, 0, pi/2)
plot!(g)
scatter!([a,b], f.([a,b]), markersize=3)

u = pi/2 * rand()
plot!([u,u], sort([f(u), g(u)]), linewidth=3)</pre>
    <div id="0cebc760-1778-40e4-b4ea-d1be8bef6ad0" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('0cebc760-1778-40e4-b4ea-d1be8bef6ad0');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.015339511014701464,0.15653518043614337,0.24005492356825142,0.3093338647765429,0.38275885138299665,0.4483830820525568,0.5161370180225519,0.590748224715583,0.6530897057668233,0.7043605909815007,0.7563355122164005,0.8041934085546572,0.8516024395353533,0.8910446310661762,0.9259160470831407,0.9502400551809932,0.9735169253637492,0.9888182032633145,0.9998007366681562],"type":"scatter","name":"y1","yaxis":"y","x":[0.015340112644426933,0.15718160432911563,0.24242242858978297,0.3144924606585486,0.3927807160357447,0.46495556277463396,0.5423346264010439,0.6319858600091139,0.7116572965148645,0.7815219666990599,0.857693210854355,0.9343171616249684,1.019034737503921,1.0996413732821289,1.1834535718383798,1.254005590649321,1.3401416088813418,1.4211120065657248,1.5508328626745866]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.16568880057750818,0.1705731418163698,0.215735929292306,0.26089871676824217,0.28803966956445215,0.31518062236066213,0.3381279525321547,0.36107528270364725,0.38600251519018913,0.41092974767673096,0.43391045117654187,0.4568911546763527,0.4815288975831677,0.5061666404899827,0.5347118818175162,0.5632571231450497,0.588624764954757,0.6139924067644643,0.6362375426138485,0.6584826784632326,0.7069890170628088,0.7557836421491348,0.8097323398038796,0.8610631643399609,0.9144353118876103,0.9593632916164181,1.014215262492244,1.0657777329517473,1.1483848091472586],"type":"scatter","name":"y2","yaxis":"y","x":[0.022837784795922588,0.030335456947418245,0.09966226221812506,0.16898906748883188,0.21065158777429593,0.25231410805976,0.2875392387302115,0.3227643694006629,0.36102873458079954,0.3992930997609362,0.434569459913952,0.4698458200669679,0.5076658063935557,0.5454857927201436,0.5893039558034936,0.6331221188868436,0.6720625311644444,0.7110029434420451,0.7451501758747727,0.7792974083075003,0.8537567071778271,0.9286585381026631,1.0114720902757113,1.090267095541802,1.172195618706738,1.2411619840694808,1.3253620991675366,1.404512690807329,1.5313180765120993]},{"showlegend":true,"mode":"markers","xaxis":"x","colorbar":{"title":""},"marker":{"symbol":"circle","color":"rgba(62, 164, 78, 1.000)","line":{"color":"rgba(0, 0, 0, 1.000)","width":1},"size":6},"y":[0.468317102141383,0.9313973972660214],"type":"scatter","name":"y3","yaxis":"y","x":[0.48738513681891865,1.1982331433090618]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(195, 113, 210, 1.000)","shape":"linear","dash":"solid","width":3},"y":[0.3900753656259436,0.41185502556326126],"type":"scatter","name":"y4","yaxis":"y","x":[0.40071344078605453,0.40071344078605453]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[0.0,0.5,1.0,1.5],"ticks":"inside","tickmode":"array","domain":[0.05100612423447069,0.9934383202099737],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.0","0.5","1.0","1.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[0.0,0.5,1.0],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.0","0.5","1.0"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<h4>Example</h4><p>For the function $f(x) = \cos(x)$ over the interval $[0, \pi/2]$ if $k=4+1$ points are chosen and a polynomial interpolates, then the difference is</p>$$~
\cos(x) - p(x) = \frac{1}{120} f^{(5)}(\xi) \prod_0^4(x-x_i)
~$$
<p>This can be as large (in absolute value) as:</p>$$~
|\cos(x) - p(x)| \leq \frac{1}{120} \cdot 1 \cdot  (\pi/2)^5 = 0.07969262624616703
~$$
<p>This is a worst case. We can graph to see the difference.</p><pre class="sourceCode julia">function dd(f,xs)
  if length(xs) == 1
     f(xs[1])
  else
	 (dd(f,xs[2:end]) - dd(f, xs[1:end-1])) / (maximum(xs) - minimum(xs))
	 end
end</pre>
<pre class="output">
dd (generic function with 1 method)</pre>

<pre class="sourceCode julia">n = 4
f(x) = cos(x)
a,b = 0, pi/2
xs = a + sort(rand(n+1)) * b

## prod_j=0^(k-1)(x-x_j)
prodk(x, k, xs) = prod([ x - xs[j+1] for j in 0:(k-1)])
## sum _(k=0)^n f[x_0, \dots x_k] prod_j=0^(k-1)(x-x_j)
p4(x) = f(xs[1]) + sum( [ dd(f, xs[1:(k+1)]) * prodk(x, k, xs) for k in 1:n])</pre>
<pre class="output">
p4 (generic function with 1 method)</pre>

<p>To visualize we try:</p><pre class="sourceCode julia">using Plots
plot(f, 0, pi/2)
plot!(p4)</pre>
    <div id="daad709c-cbac-4d23-aeef-5bfa14f433b7" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('daad709c-cbac-4d23-aeef-5bfa14f433b7');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.9998823427793041,0.9876723835796078,0.970759307795007,0.9509535004943236,0.9238482893245887,0.8938414913893011,0.8565060295332357,0.8068559567824899,0.7572805531778855,0.7098423471956228,0.6541839137126157,0.5943676990190855,0.524188215221818,0.4539157030200013,0.3777293657553397,0.3115185990107541,0.22861495145836855,0.14912599000546642,0.019962138107235735],"type":"scatter","name":"y1","yaxis":"y","x":[0.015340112644426933,0.15718160432911563,0.24242242858978297,0.3144924606585486,0.3927807160357447,0.46495556277463396,0.5423346264010439,0.6319858600091139,0.7116572965148645,0.7815219666990599,0.857693210854355,0.9343171616249684,1.019034737503921,1.0996413732821289,1.1834535718383798,1.254005590649321,1.3401416088813418,1.4211120065657248,1.5508328626745866]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.999540136474787,0.9857558373841354,0.9683359235860799,0.9483603473898499,0.9213348077745775,0.8916377389703185,0.8548753864074332,0.8061842823188134,0.7577105906290684,0.711420568548078,0.6571992990862674,0.5990193729236697,0.5308738339328178,0.46276877908088876,0.38910487302278185,0.3252644046516695,0.24562443378834953,0.16966041563369805,0.04736175565800649],"type":"scatter","name":"y2","yaxis":"y","x":[0.030335456947418245,0.16898906748883188,0.25231410805976,0.3227643694006629,0.3992930997609362,0.4698458200669679,0.5454857927201436,0.6331221188868436,0.7110029434420451,0.7792974083075003,0.8537567071778271,0.9286585381026631,1.0114720902757113,1.090267095541802,1.172195618706738,1.2411619840694808,1.3253620991675366,1.404512690807329,1.5313180765120993]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[0.5,1.0,1.5],"ticks":"inside","tickmode":"array","domain":[0.0658209390492855,0.9934383202099738],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.5","1.0","1.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[0.25,0.5,0.75],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.25","0.50","0.75"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>Not too illuminating, so we try this:</p><pre class="sourceCode julia">plot(x -> f(x) - p4(x), 0, pi/2)</pre>
    <div id="4657fb69-c412-4597-bd9f-c3c15d17c53c" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('4657fb69-c412-4597-bd9f-c3c15d17c53c');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[9.445368520655251e-7,-8.535625837247096e-7,1.2185500856132236e-6,1.873075728520135e-6,1.316847684673661e-6,4.1580744047919893e-7,-3.8277084501991965e-8,-8.056364175779152e-8,-2.8998653444078926e-6,-1.363567572376656e-5,-4.5571110059539066e-5,-0.00011786799634216916,-0.0001851137477183462,-0.00027944243439392835,-0.0004010925888425776,-0.000561417564704958,-0.0007783801683268199,-0.001057536274870985,-0.0013499702092621413,-0.001703854515427372,-0.001954045181757569,-0.0022328965000955603,-0.002542841228658582,-0.00288645210508795,-0.003242580823161645,-0.003633235568283766,-0.00406091293052005,-0.004528232450494524,-0.005366463975390007,-0.006325524021731713,-0.0068543538529771825,-0.007418292076041347,-0.008019093489222702,-0.008658572959992564,-0.008863472337589964,-0.009072269063174489,-0.009285019583083523],"type":"scatter","name":"y1","yaxis":"y","x":[0.015340112644426933,0.15718160432911563,0.24242242858978297,0.3144924606585486,0.3927807160357447,0.46495556277463396,0.5423346264010439,0.6319858600091139,0.7116572965148645,0.7815219666990599,0.857693210854355,0.9343171616249684,0.9766759495644447,1.019034737503921,1.059338055393025,1.0996413732821289,1.1415474725602544,1.1834535718383798,1.2187295812438506,1.254005590649321,1.2755395952073263,1.2970735997653313,1.3186076043233366,1.3401416088813418,1.3603842083024376,1.3806268077235333,1.400869407144629,1.4211120065657248,1.4535422205929402,1.4859724346201557,1.5021875416337633,1.5184026486473712,1.534617755660979,1.5508328626745866,1.5558237287046641,1.5608145947347416,1.565805460764819]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[0.5,1.0,1.5],"ticks":"inside","tickmode":"array","domain":[0.09545056867891513,0.9934383202099738],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.5","1.0","1.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[-0.008,-0.006,-0.004,-0.002,0.0],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-0.008","-0.006","-0.004","-0.002","0.000"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>So the actual difference is nowhere near as large as is possible ($0.079$).</p><h3>Chebyshev polynomials</h3><p>Goal, make the difference as <em>small</em> as possible:</p><p>Fix $[-1,1]$ – this is no loss of generality as we can transform a polynomial.</p><p>Define special polynomials – Chebyshev polynomials of the first kind – by the relations:</p>$$~
T_0(x) = 1, \quad
T_1(x) = x, \quad
T_{n+1}(x) = 2x T_n(x) - T_{n-1}(x).
~$$
<p>These will be polynomials with the smallest infinity norm in $[-1,1]$.</p><blockquote>
<p>Theorem. Fix $x$ in $[-1,1]$, then $T_n(x) = \cos(n \cos^{-1}(x))$ for $n \geq 0$.</p>
</blockquote><p>Pf. We need $\cos(A+B) = \cos(A) \cos(B) - \sin(A) \sin(B)$. So applying twice we get:</p>$$~
\cos((n+1)\theta) = \cos(n\theta + \theta) = \cos(n\theta) \cos\theta - \sin(n\theta) \sin\theta,\quad
\cos((n-1)\theta) = \cos(n\theta - \theta) = \cos(n\theta) \cos\theta + \sin(n\theta) \sin\theta.
~$$
<p>So, we see that adding the two will give $2 \cos(n\theta) \cos\theta$, so that</p>$$~
\cos((n+1)\theta) = 2 \cos\theta \cos(n\theta) - \cos((n-1)\theta).
~$$
<p>Now, $x = \cos\theta$ so $\theta = \cos^{-1}(x)$, so we have with $T_n = \cos(n\cos^{-1}(x))$ that these $T_n$ satisfy the defining relationship.</p><h4>Quick properties</h4><ul>
<li><p>We must have $|T_n(x)| \leq 1$ on $[-1,1]$, as the cosine function is so bounded</p>
</li>
<li><p>As $\cos^{-1}\cos(j\pi/n) = j\pi/n$ we have $T_n(\cos(j\pi/n_)$ is $(-1)^j$.</p>
</li>
<li><p>Similarly, $T_n(\cos((2j-1)\pi/(2n))) = 0$, for $1 \leq j \leq n$.</p>
</li>
<li><p>The leading coefficients are $2^{n-1}$. (Induction from the defining relationship $T_{n+1} = 2x\cdot T_n - T_{n-1}$.)</p>
</li>
</ul><blockquote>
<p>Thm: if $p$ is monic (leading coefficient $1$) then $\|p\|_\infty \geq 2^{1-n}$.</p>
</blockquote><p>Proof (p317): Assume <em>not</em>, then for <em>all</em> $x$ in $[-1,1]$ it must be $|p(x) < 2^{1-n}$. Let $q = 2^{1-n}T_n$ and $x_i = \cos(i\pi/n)$. Then $q$ is monic and $T_n(x_i)$ is $1$ or $-1$. So</p>$$~
(-1)^i p(x_i) \leq |p(x_i)| < 2^{1-n} \quad \text{(by assumption)}
~$$
<p>So, for each $i$ in $0, 1, 2, \dots n$:</p>$$~
(-1)^i (q(x_i) - p(x_i) > 0).
~$$
<p>This means the polynomial crosses $0$ atleast $n$ times. So either $q-p$ is a polynomial of degree $n$ or more or is the zero polynomial. But both $q$ and $p$ are monic of degree $n$, so their difference is a polynomial of degree <em>less</em> than $n$, hence it must be the $0$ polynomial.</p><h4>Application:</h4><p>So for a fixed number of nodes, to minimize the error between $f(x)$ and its interpolating polynomial <em>over</em> $[-1,1]$, use these Chebyshev nodes 
$$ x_i = \cos(\frac{2i-1}{2n+2}\pi). $$
</p><p>For these nodes, we have $max_{[-1,1]} |x-x_i|$ is as small as possible.</p><pre class="sourceCode julia">using Polynomials
f(x) =  sin(4x) + cos(x)^2
n = 5
xs = sort(2*rand(n) - 1)
zs = cos.((2*(0:4) +1)/(2n)* pi)
p = Polynomials.polyfit(xs, f.(xs))
q = Polynomials.polyfit(zs, f.(zs))
plot(f, -1, 1, legend=false, linewidth=3)
plot!(x->p(x), color=:green)
plot!(x->q(x), color=:red, linewidth=3)</pre>
    <div id="a50f14d6-fc92-49eb-8c5b-3c8b4574b1f2" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('a50f14d6-fc92-49eb-8c5b-3c8b4574b1f2');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":3},"y":[1.0402686768684464,1.0315439217561047,1.02255941862732,1.013319878932937,0.9166961867136902,0.8029181914016903,0.6767515889756255,0.543385702134327,0.3812473491098124,0.22608015883022003,0.10713442042058186,0.00486069037299619,-0.04206392403403014,-0.08208423180068136,-0.11463560314263921,-0.13923175590441705,-0.15451063427346645,-0.16243559879535274,-0.1628231659072764,-0.1555575696135173,-0.1392154226467095,-0.11405490796025175,-0.08019900103063349,-0.03786165904237593,0.021392460963828408,0.09100518847988381,0.17021204867515904,0.2581097860283308,0.4325141993519155,0.6244178142774208,0.8011945328572176,0.9802356173039332,1.1714510674489298,1.3514835035348685,1.4356017730437105,1.5142914609588565,1.586759934109189,1.6522655775840462,1.7157640716759701,1.7690862205446525,1.8115078670170786,1.842420359597507,1.8607027647288068,1.8678150887650595,1.8635564573368104,1.847837702765465,1.8193678563859834,1.7786913173075334,1.7260954353689515,1.6619956847833095,1.599512196776443,1.5296442124757959,1.4528353196738042,1.3695823298946985,1.1427185707188356,0.8898069890665752,0.6374112557688256,0.3800677481041095,0.1766004154163815,-0.019393340667184067,-0.2034087719848378,-0.37125244176091465,-0.3953998729241315,-0.41906117580811103,-0.44222390294061076],"type":"scatter","name":"y1","yaxis":"y","x":[-0.9951170904901059,-0.9902341809802119,-0.9853512714703179,-0.9804683619604238,-0.9353188128861314,-0.890169263811839,-0.8450197147375467,-0.7998701656632544,-0.7456041715260033,-0.6913381773887523,-0.6454569699786104,-0.5995757625684686,-0.5746558369098257,-0.5497359112511828,-0.52481598559254,-0.49989605993389713,-0.4769220926831088,-0.45394812543232044,-0.43097415818153206,-0.4080001909307437,-0.3833696699948128,-0.358739149058882,-0.33410862812295117,-0.3094781071870203,-0.28094123322099906,-0.25240435925497784,-0.22386748528895664,-0.19533061132293544,-0.1446101995504463,-0.09388978777795712,-0.049412557348758546,-0.004935326919559979,0.04355679319553948,0.09204891331063893,0.11643907435938525,0.14082923540813155,0.1652193964568779,0.1896095575056242,0.21657599944142028,0.24354244137721637,0.2705088833130125,0.29747532524880854,0.32313321430902814,0.34879110336924773,0.37444899242946733,0.4001068814896869,0.4267851328729405,0.45346338425619404,0.48014163563944756,0.5068198870227011,0.5292772921004484,0.5517346971781957,0.574192102255943,0.5966495073336903,0.6514853996532093,0.7063212919727282,0.7578686481150726,0.809416004257417,0.8507074352010927,0.8919988661447684,0.9332902970884441,0.9745817280321198,0.9809362960240899,0.9872908640160599,0.9936454320080299]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 128, 0, 1.000)","shape":"linear","dash":"solid","width":1},"y":[1.659005073120173,0.753293452777775,0.3035583664968835,0.02888516669442931,-0.13560958187545546,-0.1545240631738265,-0.03596134978194332,0.25930145496911294,0.626716702706297,0.9896125115247965,1.3751017858750076,1.684000086483143,1.7909034891952,1.8325318418762555,1.7959455055115678,1.6690446516545134,1.423288840929561,1.0417301645160042,0.5997279729510042,0.03318850519612582,-0.37978581170517645,-0.8476045977931588,-1.3736206608250052,-1.9612695035012253,-2.573018939085146,-3.2453277479659057,-3.981249567814909,-4.783902608398289,-5.477136919046694,-6.216897057799209,-7.004875439584844,-7.842791065701621,-8.73238952381653,-9.675442987965589,-10.673750218553781,-11.729136562355109,-12.06574905265575,-12.407998714717351,-12.755940294040734],"type":"scatter","name":"y2","yaxis":"y","x":[-0.9756951956220518,-0.7961117334087657,-0.6881895580224973,-0.5969427322382433,-0.49782310381154626,-0.4064435736886114,-0.30847505979464146,-0.19496892888889,-0.0940980748300903,-0.0056434258479865175,0.09079588527340125,0.1878083616962823,0.2414382107833156,0.2950680598703489,0.34609550803972855,0.39712295620910826,0.4501796627259069,0.5032363692427057,0.5478988148138888,0.5925612603850718,0.6198251522682725,0.6470890441514732,0.6743529360346738,0.7016168279178746,0.7272456904253143,0.752874552932754,0.7785034154401936,0.8041322779476333,0.8246619905379089,0.8451917031281844,0.8657214157184598,0.8862511283087353,0.9067808408990108,0.9273105534892864,0.947840266079562,0.9683699786698374,0.9746888420043855,0.9810077053389337,0.9873265686734818]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(255, 0, 0, 1.000)","shape":"linear","dash":"solid","width":3},"y":[1.1933897270994098,1.1618381973816225,1.1307802387847083,1.100212810638548,0.9651820091889574,0.8402720624500983,0.7251856295643917,0.6196270857105368,0.523302522103506,0.43591974599454686,0.3571882806711817,0.28681936545720876,0.21290234728599633,0.15015621195714512,0.09808942735579951,0.05621404252812934,0.00723702565624762,-0.016300881966659686,-0.019238991748147027,-0.015711633940669323,-0.006079469072241217,0.009299390448365696,0.05152910215858286,0.10988257088485998,0.1878779986482937,0.2792601088528984,0.3984462646127973,0.5281183695329466,0.7723429416187035,0.9866727471629275,1.0982683129050135,1.2033179915578054,1.30018101620651,1.3860266222402937,1.465529141964308,1.5260909600710022,1.5635780171640619,1.5790302956385607,1.577588754715903,1.5692456499133696,1.5536842146734515,1.5305910294887937,1.5050851149986555,1.4738392676051943,1.436672049898786,1.3934037050957686,1.3320474441868944,1.2610110613970573,1.179977622145241,1.0886339258344486,0.993090232961106,0.8879082778509899,0.7728369226353997,0.6476279451156877,0.539852601658533,0.42529012258979515,0.30381697111378614,0.1753108109081859,0.03965050612403964,-0.10328387861424337,-0.25361107820888407,-0.4114486270887374,-0.4615592246534348,-0.5123957167656465,-0.5639614619101059],"type":"scatter","name":"y3","yaxis":"y","x":[-0.9902616167730923,-0.9854061430560788,-0.9805506693390653,-0.9756951956220518,-0.953247262845391,-0.9307993300687303,-0.9083513972920695,-0.8859034645154087,-0.863455531738748,-0.8410075989620872,-0.8185596661854264,-0.7961117334087657,-0.7691311895621986,-0.7421506457156315,-0.7151701018690644,-0.6881895580224973,-0.6425661451303704,-0.5969427322382433,-0.5721628251315691,-0.5473829180248948,-0.5226030109182205,-0.49782310381154626,-0.45213333875007883,-0.4064435736886114,-0.35745931674162645,-0.30847505979464146,-0.25172199434176573,-0.19496892888889,-0.0940980748300903,-0.0056434258479865175,0.042576229712707366,0.09079588527340125,0.13930212348484178,0.1878083616962823,0.2414382107833156,0.2950680598703489,0.34609550803972855,0.39712295620910826,0.4236513094675076,0.4501796627259069,0.4767080159843063,0.5032363692427057,0.5255675920282972,0.5478988148138888,0.5702300375994803,0.5925612603850718,0.6198251522682725,0.6470890441514732,0.6743529360346738,0.7016168279178746,0.7272456904253143,0.752874552932754,0.7785034154401936,0.8041322779476333,0.8246619905379089,0.8451917031281844,0.8657214157184598,0.8862511283087353,0.9067808408990108,0.9273105534892864,0.947840266079562,0.9683699786698374,0.9746888420043855,0.9810077053389337,0.9873265686734818]}], {"showlegend":false,"xaxis":{"gridwidth":0.5,"tickvals":[-0.5,0.0,0.5],"ticks":"inside","tickmode":"array","domain":[0.05100612423447069,0.9934383202099737],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-0.5","0.0","0.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[-10.0,-5.0,0.0],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-10","-5","0"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"width":600});
    </script>
<h2>The errors can grow!</h2><p>Fix a function $f$ and an interval $[a,b]$. We would expect that if we take more and more points to interpolate $f$ that the interpolating polynomial would get closer and closer to $p$. In fact, w might expect that $\|f-p_n\|_\infty \rightarrow 0$ as $n \rightarrow \infty$.</p><p>However, the bound on the error depends on the derivatives of the function. For some functions, these may get big, so it isn't the case that we definitely know that $\| f -p_n \|_\infty \rightarrow 0$. In fact:</p><blockquote>
<p>p319: "The surprising state of affairs is that for most continuous functions the quantity will not converge to 0"</p>
</blockquote><p>Example, (Runge 1901). Let $f(x) = 1/(x^2+1)$ and $[a,b] = [-5,5]$. We will use <em>evenly</em> spaced points and have a look:</p><pre class="sourceCode julia">f(x) = 1/(x^2 + 1)
a,b = -5, 5


function show_n(n)
  xs = linspace(a, b, n + 1 + 2)[2:end-1]

  ip(x)  = f(xs[1]) + sum( [ dd(f, xs[1:(k+1)]) * prodk(x, k, xs) for k in 1:n])
  plot(f, a, b)
  plot!(ip)
end

show_n(2)</pre>
    <div id="fb534c0e-1c16-4149-95b1-f029c368d4e9" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('fb534c0e-1c16-4149-95b1-f029c368d4e9');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.039194024537107755,0.03994734106325983,0.048053744178108565,0.058841503594498704,0.06712247519216975,0.07722775891986576,0.08760120949187186,0.10012738830645612,0.10804114277859542,0.11688743757895442,0.1268102887039397,0.1379804834824026,0.14955804709685674,0.16255609670765234,0.17719600390409945,0.19373822950091155,0.2139354287862782,0.23711603768286524,0.2638025180815644,0.2946013590347598,0.336338018767323,0.385698453424391,0.44386913594351257,0.5118097036178259,0.5806363126562478,0.6566838699583735,0.7377275201593693,0.8194153544338916,0.8537713314557387,0.8862519833887288,0.9160842404878181,0.9424715190672456,0.9541284352175221,0.9646370571976748,0.9739116270850849,0.9818740374723359,0.9884553979457603,0.9935974742370571,0.9972539460671858,0.9993914342826798,0.9999682935147097,0.9987100891194404,0.9956306306497575,0.9907634979515042,0.9841611327487687,0.9758934443510366,0.9660459976579969,0.95471786910344,0.9420192673071214,0.9280690195913227,0.9129920234221258,0.8969167540705226,0.86228924290948,0.8252016170884897,0.7468530687177962,0.6685288141725143,0.5943761704914166,0.5266499051995003,0.4602718454620676,0.4027673307473901,0.3771372209423674,0.35343477114982735,0.3315333413141352,0.3113044713380672,0.2769793958452104,0.24744017909173877,0.22196074268695343,0.19991451993442708,0.16284719371852546,0.1347407462933523,0.11614024973403758,0.10101248995509683,0.07422668310443208,0.05754118451731878,0.040411814795740346],"type":"scatter","name":"y1","yaxis":"y","x":[-4.951170904901059,-4.9023418098021185,-4.450846319059195,-3.9993508283162718,-3.7280208576300167,-3.456690886943761,-3.227284849893052,-2.997878812842343,-2.8732791845491286,-2.7486795562559143,-2.6240799279627,-2.499480299669486,-2.384610463415544,-2.2697406271616023,-2.15487079090766,-2.0400009546537183,-1.916848349974064,-1.7936957452944098,-1.6705431406147557,-1.5473905359351015,-1.4047061661049955,-1.2620217962748894,-1.1193374264447833,-0.9766530566146772,-0.8498520271834542,-0.7230509977522314,-0.5962499683210085,-0.46944893888978556,-0.41385240085328734,-0.3582558628167891,-0.3026593247802909,-0.24706278674379273,-0.21926451772554362,-0.1914662487072945,-0.1636679796890454,-0.1358697106707963,-0.1080714416525472,-0.0802731726342981,-0.052474903616049,-0.024676634597799892,0.00563094047413726,0.03593851554607441,0.06624609061801157,0.09655366568994872,0.12686124076188587,0.15716881583382303,0.18747639090576018,0.21778396597769734,0.2480915410496345,0.27839911612157164,0.3087066911935088,0.33901426626544595,0.39962941640932026,0.46024456655319457,0.5821953717969262,0.7041461770406577,0.8260969822843893,0.9480477875281209,1.0828799972071013,1.2177122068860817,1.2851283117255718,1.3525444165650622,1.4199605214045525,1.4873766262440427,1.6156660715451405,1.7439555168462386,1.8722449621473367,2.0005344074484346,2.26731692128097,2.5340994351135055,2.758673485890978,2.983247536668451,3.531606459863641,4.047080021287085,4.872908640160599]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[-2.348573860818049,-2.3160521678840214,-2.2836891735480918,-2.25148487781026,-1.9612274665615244,-1.6845382658135102,-1.421417275566217,-1.1718644958196462,-0.8898771301249537,-0.6274904501615208,-0.42093767940574195,-0.22839643393501458,-0.03511972977100841,0.141623306324919,0.28991730759359546,0.42415899876573754,0.5524715613682099,0.6646322497423007,0.7743839114344127,0.8624541131101304,0.9225250254676647,0.965472881719315,0.9890430264863359,0.9994460386091915,0.9957844716279345,0.9764713283438062,0.9412520165955349,0.8901945324618032,0.8153079984285656,0.7210606766005883,0.6134123759194345,0.4882366721047781,0.339496176988032,0.17180650058763874,0.015958178941549883,-0.15331763386130098,-0.37818820603096254,-0.6230733161336011,-0.8715226481728242,-1.1376579357496344,-1.3636004008494191,-1.6008912913016256,-1.8495306071062545,-2.1095183482633053,-2.150536931255061,-2.1918242885843338,-2.2333804202511205],"type":"scatter","name":"y2","yaxis":"y","x":[-4.92718585918279,-4.903200813464522,-4.8792157677462535,-4.855230722027985,-4.633454341263228,-4.411677960498471,-4.189901579733714,-3.9681251989689583,-3.7015684774708566,-3.4350117559727544,-3.209641440362401,-2.9842711247520484,-2.7394557928245185,-2.494640460896988,-2.2689423791596015,-2.0432442974222154,-1.8012721005113241,-1.559299903600433,-1.2789513837908413,-0.9986028639812498,-0.7494621840756421,-0.5003215041700344,-0.2818475793297926,-0.06337365448955082,0.17482156817015992,0.41301679082987064,0.652627673089619,0.8922385553493672,1.1571590259739144,1.4220794965984616,1.6741446396844264,1.926209782770391,2.188299046482625,2.4503883101948594,2.67101164405432,2.891634977913781,3.160991061949476,3.430347145985171,3.6835498095251777,3.936752473065185,4.139577624125231,4.342402775185276,4.545227926245321,4.748053077305366,4.779266968019174,4.810480858732983,4.841694749446791]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[-2.5,0.0,2.5],"ticks":"inside","tickmode":"array","domain":[0.03619130941965587,0.9934383202099738],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-2.5","0.0","2.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[-2.0,-1.0,0.0],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-2","-1","0"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<pre class="sourceCode julia">show_n(5)</pre>
    <div id="e89001ce-b897-41a3-8c87-5bb557120308" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('e89001ce-b897-41a3-8c87-5bb557120308');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.039194024537107755,0.03994734106325983,0.048053744178108565,0.058841503594498704,0.06712247519216975,0.07722775891986576,0.08760120949187186,0.10012738830645612,0.10804114277859542,0.11688743757895442,0.1268102887039397,0.1379804834824026,0.16255609670765234,0.19373822950091155,0.23711603768286524,0.2946013590347598,0.336338018767323,0.385698453424391,0.44386913594351257,0.5118097036178259,0.5806363126562478,0.6566838699583735,0.7377275201593693,0.8194153544338916,0.8537713314557387,0.8862519833887288,0.9160842404878181,0.9424715190672456,0.9541284352175221,0.9646370571976748,0.9739116270850849,0.9818740374723359,0.9884553979457603,0.9935974742370571,0.9972539460671858,0.9993914342826798,0.9999682935147097,0.9987100891194404,0.9956306306497575,0.9907634979515042,0.9841611327487687,0.9758934443510366,0.9660459976579969,0.95471786910344,0.9420192673071214,0.9280690195913227,0.9129920234221258,0.8969167540705226,0.8799729075787618,0.86228924290948,0.8439916704373183,0.8252016170884897,0.7863673739886209,0.7468530687177962,0.7073793448626581,0.6685288141725143,0.6307512563159255,0.5943761704914166,0.5596292159866169,0.5266499051995003,0.49232782976965295,0.4602718454620676,0.430444269009039,0.4027673307473901,0.35343477114982735,0.3113044713380672,0.2769793958452104,0.24744017909173877,0.22196074268695343,0.19991451993442708,0.16284719371852546,0.1347407462933523,0.11614024973403758,0.10101248995509683,0.07422668310443208,0.05754118451731878,0.040411814795740346],"type":"scatter","name":"y1","yaxis":"y","x":[-4.951170904901059,-4.9023418098021185,-4.450846319059195,-3.9993508283162718,-3.7280208576300167,-3.456690886943761,-3.227284849893052,-2.997878812842343,-2.8732791845491286,-2.7486795562559143,-2.6240799279627,-2.499480299669486,-2.2697406271616023,-2.0400009546537183,-1.7936957452944098,-1.5473905359351015,-1.4047061661049955,-1.2620217962748894,-1.1193374264447833,-0.9766530566146772,-0.8498520271834542,-0.7230509977522314,-0.5962499683210085,-0.46944893888978556,-0.41385240085328734,-0.3582558628167891,-0.3026593247802909,-0.24706278674379273,-0.21926451772554362,-0.1914662487072945,-0.1636679796890454,-0.1358697106707963,-0.1080714416525472,-0.0802731726342981,-0.052474903616049,-0.024676634597799892,0.00563094047413726,0.03593851554607441,0.06624609061801157,0.09655366568994872,0.12686124076188587,0.15716881583382303,0.18747639090576018,0.21778396597769734,0.2480915410496345,0.27839911612157164,0.3087066911935088,0.33901426626544595,0.3693218413373831,0.39962941640932026,0.4299369914812574,0.46024456655319457,0.5212199691750603,0.5821953717969262,0.643170774418792,0.7041461770406577,0.7651215796625235,0.8260969822843893,0.8870723849062552,0.9480477875281209,1.0154638923676111,1.0828799972071013,1.1502961020465916,1.2177122068860817,1.3525444165650622,1.4873766262440427,1.6156660715451405,1.7439555168462386,1.8722449621473367,2.0005344074484346,2.26731692128097,2.5340994351135055,2.758673485890978,2.983247536668451,3.531606459863641,4.047080021287085,4.872908640160599]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[1.8755246422262701,1.8157233550507321,1.7571640803395066,1.6998328738441484,1.4503448436985105,1.2254594805706902,1.0238558416455663,0.8442442232061438,0.6853661606335558,0.5459944284070639,0.42493304010405747,0.3210172484000512,0.2663421078882576,0.2172085613338074,0.17338009770930884,0.13462428050208058,0.07142121186226151,0.025821353607107633,-0.000268603393932601,-0.015999291522944076,-0.02233625353556805,-0.020211718387640062,-0.009362851378937165,0.009302789376292031,0.034723890876908386,0.06588552663948091,0.13517170139510398,0.21505492123835412,0.306654292960541,0.3989279827411338,0.5002406246123893,0.5894225503361975,0.6542785644357573,0.7026496147698952,0.7299055068771598,0.7420952002599256,0.7377936021318029,0.7153053603040394,0.6751650377310917,0.6189668704860114,0.5408082370013031,0.449655958421948,0.3553773712690243,0.2589359756543471,0.16277522723902405,0.07837461183506732,0.022750444656755117,-0.012762325170506364,-0.02193617752791556,-0.01983218241535968,-0.004888921949595906,0.024522996011031237,0.0668800834946378,0.12498649240308045,0.20036000888406813,0.29457149657804804,0.3847193030009294,0.48885501546348176,0.607859756249813,0.7426365013226729,0.8941100803234502,1.0632271765721701,1.2509563270675064,1.4582879224867704,1.5262041340047525,1.5961030621103967,1.6680148353522921],"type":"scatter","name":"y2","yaxis":"y","x":[-4.92718585918279,-4.903200813464522,-4.8792157677462535,-4.855230722027985,-4.744342531645606,-4.633454341263228,-4.5225661508808495,-4.411677960498471,-4.300789770116093,-4.189901579733714,-4.079013389351337,-3.9681251989689583,-3.901486018594433,-3.8348468382199075,-3.768207657845382,-3.7015684774708566,-3.5682901167218057,-3.4350117559727544,-3.322326598167578,-3.209641440362401,-3.0969562825572248,-2.9842711247520484,-2.8618634587882834,-2.7394557928245185,-2.6170481268607535,-2.494640460896988,-2.2689423791596015,-2.0432442974222154,-1.8012721005113241,-1.559299903600433,-1.2789513837908413,-0.9986028639812498,-0.7494621840756421,-0.5003215041700344,-0.2818475793297926,-0.06337365448955082,0.17482156817015992,0.41301679082987064,0.652627673089619,0.8922385553493672,1.1571590259739144,1.4220794965984616,1.6741446396844264,1.926209782770391,2.188299046482625,2.4503883101948594,2.67101164405432,2.891634977913781,3.0263130199316284,3.160991061949476,3.2956691039673234,3.430347145985171,3.5569484777551743,3.6835498095251777,3.810151141295181,3.936752473065185,4.038165048595208,4.139577624125231,4.240990199655253,4.342402775185276,4.443815350715298,4.545227926245321,4.646640501775344,4.748053077305366,4.779266968019174,4.810480858732983,4.841694749446791]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[-2.5,0.0,2.5],"ticks":"inside","tickmode":"array","domain":[0.05100612423447069,0.9934383202099737],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-2.5","0.0","2.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[0.0,0.5,1.0,1.5],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.0","0.5","1.0","1.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<pre class="sourceCode julia">show_n(7)</pre>
    <div id="1241d320-484e-4c6a-b0ca-37d7cde6835a" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('1241d320-484e-4c6a-b0ca-37d7cde6835a');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.03994734106325983,0.058841503594498704,0.07722775891986576,0.10012738830645612,0.11688743757895442,0.1379804834824026,0.16255609670765234,0.19373822950091155,0.23711603768286524,0.2946013590347598,0.336338018767323,0.385698453424391,0.44386913594351257,0.5118097036178259,0.5806363126562478,0.6566838699583735,0.7377275201593693,0.8194153544338916,0.8862519833887288,0.9424715190672456,0.9646370571976748,0.9818740374723359,0.9935974742370571,0.9993914342826798,0.9987100891194404,0.9907634979515042,0.9758934443510366,0.95471786910344,0.9280690195913227,0.8969167540705226,0.86228924290948,0.8252016170884897,0.7468530687177962,0.6685288141725143,0.5943761704914166,0.5266499051995003,0.4602718454620676,0.4027673307473901,0.35343477114982735,0.3113044713380672,0.2769793958452104,0.24744017909173877,0.22196074268695343,0.19991451993442708,0.16284719371852546,0.1347407462933523,0.11614024973403758,0.10101248995509683,0.07422668310443208,0.05754118451731878,0.040411814795740346],"type":"scatter","name":"y1","yaxis":"y","x":[-4.9023418098021185,-3.9993508283162718,-3.456690886943761,-2.997878812842343,-2.7486795562559143,-2.499480299669486,-2.2697406271616023,-2.0400009546537183,-1.7936957452944098,-1.5473905359351015,-1.4047061661049955,-1.2620217962748894,-1.1193374264447833,-0.9766530566146772,-0.8498520271834542,-0.7230509977522314,-0.5962499683210085,-0.46944893888978556,-0.3582558628167891,-0.24706278674379273,-0.1914662487072945,-0.1358697106707963,-0.0802731726342981,-0.024676634597799892,0.03593851554607441,0.09655366568994872,0.15716881583382303,0.21778396597769734,0.27839911612157164,0.33901426626544595,0.39962941640932026,0.46024456655319457,0.5821953717969262,0.7041461770406577,0.8260969822843893,0.9480477875281209,1.0828799972071013,1.2177122068860817,1.3525444165650622,1.4873766262440427,1.6156660715451405,1.7439555168462386,1.8722449621473367,2.0005344074484346,2.26731692128097,2.5340994351135055,2.758673485890978,2.983247536668451,3.531606459863641,4.047080021287085,4.872908640160599]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[-4.066067395120404,-3.959058220916823,-3.854043803121613,-3.750997892113998,-3.6498944682395367,-3.55070774059138,-3.4534121457945366,-3.3579823467930416,-2.9403272733255625,-2.559603537900748,-2.2134910071523213,-1.8997668103828769,-1.6163028668497432,-1.361063442268523,-1.1321027345342616,-0.9275624886602771,-0.7456696409346548,-0.5847339922943775,-0.4431459109171154,-0.31937406403068036,-0.21196317894012853,-0.11953183327251213,-0.040770274439286186,0.02556173168362362,0.09049148828204821,0.14106821454573618,0.17907274997427008,0.20615989858320463,0.2336009417358231,0.23429658466000386,0.19961410819042658,0.14872186271402826,0.1026029025964349,0.08385069521621392,0.09825369362895428,0.14390827566136993,0.22349948576597498,0.3268418103904337,0.4624754368830333,0.5982534850573957,0.7052227374534601,0.7885284232439329,0.8358526105262297,0.8555330337891189,0.8439079122221281,0.7987814536200879,0.7234499187266801,0.6246182118906279,0.3685773021080405,0.1634563285580298,0.10286144462104582,0.08388424703063732,0.09990236188156906,0.13910407370732011,0.19962080153209058,0.236425211874242,0.22904616179665524,0.19495145768385555,0.1649010654108458,0.12440188533064564,0.0719945445731571,0.006115576589011268,-0.1317327825857977,-0.3159651817974283,-0.42802520283031353,-0.554842564284397,-0.6975792942205683,-0.8574518794556714,-1.0357327121648556,-1.2337515535796701,-1.4528970147817557,-1.6946180545919713,-1.9604254945553887,-2.251893551021625,-2.5706613843210007,-2.9184346650361177,-3.1477071449528835,-3.3890686185416583,-3.6429560757358614],"type":"scatter","name":"y2","yaxis":"y","x":[-4.890408893956189,-4.878475978110259,-4.866543062264329,-4.854610146418399,-4.84267723057247,-4.830744314726539,-4.81881139888061,-4.80687848303468,-4.751709964296669,-4.696541445558657,-4.641372926820646,-4.586204408082635,-4.531035889344624,-4.475867370606613,-4.420698851868602,-4.36553033313059,-4.310361814392579,-4.255193295654568,-4.200024776916557,-4.144856258178545,-4.089687739440533,-4.0345192207025224,-3.9793507019645116,-3.9241821832265003,-3.8578742227755205,-3.7915662623245407,-3.725258301873561,-3.6589503414225812,-3.5263344205206217,-3.3937184996186622,-3.1694683529282512,-2.9452182062378403,-2.7016196917301545,-2.4580211772224687,-2.2334448935167712,-2.0088686098110733,-1.768099098949299,-1.5273295880875248,-1.2483744980106466,-0.9694194079337685,-0.7215170439331089,-0.47361467993244943,-0.25622664654939004,-0.038838613166330666,0.19817269632105533,0.43518400580844135,0.673603938574862,0.9120238713412826,1.4392313186748509,1.9408559018368612,2.201642490675229,2.4624290795135964,2.6819558386048405,2.9014825976960847,3.1694998882313272,3.4375171787665697,3.56348925784778,3.68946133692899,3.752447376469595,3.8154334160102,3.878419455550805,3.9414054950914106,4.042314014819353,4.143222534547296,4.193676794411267,4.244131054275238,4.294585314139209,4.345039574003181,4.395493833867152,4.445948093731124,4.496402353595095,4.546856613459067,4.597310873323038,4.64776513318701,4.69821939305098,4.748673652914952,4.779732399726363,4.810791146537776,4.841849893349187]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[-2.5,0.0,2.5],"ticks":"inside","tickmode":"array","domain":[0.03619130941965587,0.9934383202099738],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-2.5","0.0","2.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[-4.0,-3.0,-2.0,-1.0,0.0],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-4","-3","-2","-1","0"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<pre class="sourceCode julia">show_n(15)</pre>
    <div id="35e87e2d-ac9d-4777-b674-a559df34e6fe" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('35e87e2d-ac9d-4777-b674-a559df34e6fe');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.03994734106325983,0.058841503594498704,0.07722775891986576,0.10012738830645612,0.11688743757895442,0.1379804834824026,0.16255609670765234,0.19373822950091155,0.23711603768286524,0.2946013590347598,0.336338018767323,0.385698453424391,0.44386913594351257,0.5118097036178259,0.5806363126562478,0.6566838699583735,0.7377275201593693,0.8194153544338916,0.8862519833887288,0.9424715190672456,0.9646370571976748,0.9818740374723359,0.9935974742370571,0.9993914342826798,0.9987100891194404,0.9907634979515042,0.9758934443510366,0.95471786910344,0.9280690195913227,0.8969167540705226,0.86228924290948,0.8252016170884897,0.7468530687177962,0.6685288141725143,0.5943761704914166,0.5266499051995003,0.4602718454620676,0.4027673307473901,0.35343477114982735,0.3113044713380672,0.2769793958452104,0.24744017909173877,0.22196074268695343,0.19991451993442708,0.16284719371852546,0.1347407462933523,0.11614024973403758,0.10101248995509683,0.07422668310443208,0.05754118451731878,0.040411814795740346],"type":"scatter","name":"y1","yaxis":"y","x":[-4.9023418098021185,-3.9993508283162718,-3.456690886943761,-2.997878812842343,-2.7486795562559143,-2.499480299669486,-2.2697406271616023,-2.0400009546537183,-1.7936957452944098,-1.5473905359351015,-1.4047061661049955,-1.2620217962748894,-1.1193374264447833,-0.9766530566146772,-0.8498520271834542,-0.7230509977522314,-0.5962499683210085,-0.46944893888978556,-0.3582558628167891,-0.24706278674379273,-0.1914662487072945,-0.1358697106707963,-0.0802731726342981,-0.024676634597799892,0.03593851554607441,0.09655366568994872,0.15716881583382303,0.21778396597769734,0.27839911612157164,0.33901426626544595,0.39962941640932026,0.46024456655319457,0.5821953717969262,0.7041461770406577,0.8260969822843893,0.9480477875281209,1.0828799972071013,1.2177122068860817,1.3525444165650622,1.4873766262440427,1.6156660715451405,1.7439555168462386,1.8722449621473367,2.0005344074484346,2.26731692128097,2.5340994351135055,2.758673485890978,2.983247536668451,3.531606459863641,4.047080021287085,4.872908640160599]},{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(227, 111, 71, 1.000)","shape":"linear","dash":"solid","width":1},"y":[-94.85563560362797,-88.32035905531741,-82.15923306388054,-76.35414653443586,-70.88773516145378,-65.74335515261637,-63.28691645141751,-60.90505773953869,-58.59588996246916,-56.35756445542652,-46.87923438229787,-38.70955193108488,-31.696569202992432,-25.70332896184344,-20.60660401251637,-16.295726775533307,-12.671503600691736,-9.645208638866011,-7.137652355827701,-5.078320025535978,-3.404575783199972,-2.060928050882578,-0.17366789467453178,0.9089264635525156,1.595608405020403,1.328679968736131,0.8052830681577869,0.34257355890133745,-0.10817789934813393,-0.0030878597787261097,0.11299744644638905,0.1446791155380367,0.12571591523022735,0.2018164000344331,0.30294653104904723,0.5110638215264758,0.8267263376094758,0.9850882474414058,0.8492163415892582,0.5443171113841776,0.3239955945831815,0.21665276363200223,0.12543534167234952,0.1434267281216676,0.11298704727606854,-0.03138886525515436,-0.09769364905458208,0.4049160800782712,0.8424684243169818,1.3216535208174403,1.5963514827721976,1.1583411429498849,0.4041695233605562,-0.9198909106108974,-3.03185990600492,-6.208431230674032,-8.301392526422214,-10.797076840990494,-13.752286991564924,-17.230130050996202,-21.300584206929905,-26.04110741056798,-31.537290346281004,-37.88355637906103,-40.02380318129804,-42.257586950838466,-44.58822829378392,-47.01914561952095,-52.195985393986355,-57.81750251817699,-63.9148177100467,-70.52086076190314,-77.67045861809972],"type":"scatter","name":"y2","yaxis":"y","x":[-4.890408893956189,-4.878475978110259,-4.866543062264329,-4.854610146418399,-4.84267723057247,-4.830744314726539,-4.824777856803575,-4.81881139888061,-4.812844940957644,-4.80687848303468,-4.779294223665675,-4.751709964296669,-4.724125704927664,-4.696541445558657,-4.668957186189651,-4.641372926820646,-4.61378866745164,-4.586204408082635,-4.558620148713629,-4.531035889344624,-4.503451629975618,-4.475867370606613,-4.420698851868602,-4.36553033313059,-4.255193295654568,-4.144856258178545,-4.0345192207025224,-3.9241821832265003,-3.6589503414225812,-3.3937184996186622,-3.1694683529282512,-2.9452182062378403,-2.4580211772224687,-2.0088686098110733,-1.5273295880875248,-0.9694194079337685,-0.47361467993244943,-0.038838613166330666,0.43518400580844135,0.9120238713412826,1.4392313186748509,1.9408559018368612,2.4624290795135964,2.9014825976960847,3.1694998882313272,3.4375171787665697,3.68946133692899,3.9414054950914106,4.042314014819353,4.143222534547296,4.244131054275238,4.345039574003181,4.395493833867152,4.445948093731124,4.496402353595095,4.546856613459067,4.572083743391053,4.597310873323038,4.622538003255023,4.64776513318701,4.672992263118995,4.69821939305098,4.723446522982966,4.748673652914952,4.756438339617805,4.764203026320658,4.7719677130235105,4.779732399726363,4.7952617731320695,4.810791146537776,4.826320519943481,4.841849893349187,4.857379266754894]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[-2.5,0.0,2.5],"ticks":"inside","tickmode":"array","domain":[0.05100612423447069,0.9934383202099737],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-2.5","0.0","2.5"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[-80.0,-60.0,-40.0,-20.0,0.0],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["-80","-60","-40","-20","0"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>
<p>(There are better functions to approximate over an entire interval.)</p><p>Some theorems:</p><blockquote>
<p>Faber's Theorem p320: For each $n$, fix a set of nodes $a \leq x^{(n)}_1 < x^{(n)}_2 < \cdots <   x^{(n)}_n \leq b$. There is some function $f$ for which the interpolating polynomial will not converge uniformly to $f$.</p>
</blockquote><p>Meanwhile</p><blockquote>
<p>Convergence of interpolants p320: For each $f$ there is a system of nodes such that $p_n$ converges uniformly to $f$.</p>
</blockquote><p>So not all nodes will work, but for each $f$ some nodes will.</p><p>This next theorem is similar, but speaks just to the size of an error:</p><blockquote>
<p>Weirstrass Approximation Theorem. Let $f$ be continuous on $[a,b]$. Then for any $\epsilon > 0$ there exists a polynomial $p$ with $\|f-p\|_\infty < \epsilon$.</p>
</blockquote><p>The classic proof of this is <em>constructive</em>. Assume $[a,b] = [0,1]$. The Bernstein basis for the polynomials of degree $n$ is:</p>$$~
g_{nk}(x) = {n \choose k}x^k(1-x)^{n-k}
~$$
<p>With this, we can defined a $n$th degree polynomial approximation to $f$ by:</p>$$~
B_n(f)(x) = \sum_{k=0}^n f(x/k) \cdot g_{nk}(x).
~$$
<p><a href="https://en.wikipedia.org/wiki/Bernstein_polynomial">Wikipedia</a> shows that $B_n(f) \rightarrow f$ <em>uniformly</em> on $[0,1]$.</p><p>Wikipedia's proof uses probability. The book's proof uses Thm 9 (Bohman-Korovkin) to show that if we can prove convergence for three functions $1$, $x$ and $x^2$ then it will be true – provided $B_n(f)$ is a <em>linear operator</em> (which it is).</p><p>So, we would need to show the explicit <em>uniform</em> convergence of $B_n(x^k)$ for $k=0,1,2$. For $k=0$, $f(k/n) = 1$ and so:</p>$$~
B_n(1) = \sum_k g_{nk}(x) = \sum {n \choose k}x^k (1-x)^{n-k} = (x + (1-x))^n = 1.
~$$
<p>and for $k=1$, $f(k/n) = k/n$ and so</p>$$~
B_n(x) = \sum {n \choose k} (k/n) x^k (1-x)^{n-k} = \sum_{k=1}^n {n-1 \choose k-1}x^k(1-x)^{n-k} = x \sum_{k=0}^{n-1} {n-1 \choose k} x^k (1-x)^{(n-1)-k} = x.
~$$
<p>And for $k=2$, we will get (p323) $B_n(x^2)(x) = (n-1)/n x^2 + x/n$ which converges uniformly to $x^2$.</p><h3>ApproxFun</h3><p>In Julia, the <code>ApproxFun</code> package does computations by finding a high order polynomial approximation to the function $f$ and then solving using the polynomial approximation.</p><p>For example, we have from the <a href="https://github.com/JuliaApproximation/ApproxFun.jl">Readme</a></p><pre class="sourceCode julia">using ApproxFun
x = x = Fun(identity,0..pi)
f = sin(x^2)
g = cos(x)</pre>
<p>And then</p><pre class="sourceCode julia">h = f + g^2
r = roots(h)
rp = roots(h')

using Plots
plot(h)
scatter!(r,h.(r))
scatter!(rp,h.(rp))</pre>
<p>Secretly <code>h</code> is a high order polynomial:</p><pre class="sourceCode julia">h.coefficients</pre>
<h3>Bezier Curves</h3><p>The Bernstein polynomials find another usage:</p><p>Consider this great graphic: https://www.jasondavies.com/animated-bezier/</p><p>There are $n+1$ points $P_0, P_1, \dots, P_n$. The blue circles <em>interpolate</em> between $P_i$ and $P_{i+1}$ at the same rate. Between adjacent blue circles are further interpolations, and so on until there is just one circle, which lays out a trajectory. The resulting trajectory is the Bezier curve for the given control points.</p><p>What are the mathematics behind this? The Bernstein basis comes in:</p>$$~
B(t) = \sum_{k=0}^n {n \choose k} t^k (1-t)^k P_k
~$$
<p>Can we graph?</p><pre class="sourceCode julia">choose(n,k) = gamma(n+1) / gamma(k+1) / gamma(n-k+1)   </pre>
<pre class="output">
choose (generic function with 1 method)</pre>

<pre class="sourceCode julia">Ps = [[0,0], [1,1/2], [1/2, 1], [0,1/2]]
n = length(Ps) - 1
B(t) = sum(choose(n,k) * t^k *(1-t)^(n-k) * Ps[k+1] for k in 0:n)
plot(t -> B(t)[1], t -> B(t)[2], 0, 1)
scatter!([u[1] for u in Ps], [u[2] for u in Ps])</pre>
    <div id="acb9a8e2-d795-4762-9507-f5cb6e17f2d1" style="width:600px;height:400px;"></div>
    <script>
    PLOT = document.getElementById('acb9a8e2-d795-4762-9507-f5cb6e17f2d1');
    Plotly.plot(PLOT, [{"showlegend":true,"mode":"lines","xaxis":"x","colorbar":{"title":""},"line":{"color":"rgba(0, 154, 250, 1.000)","shape":"linear","dash":"solid","width":1},"y":[0.0,0.007537561548303625,0.015074361733162667,0.022609639191132555,0.03014263255876869,0.03767258047262651,0.04519872156926143,0.052720294485228844,0.06023653785708421,0.06774669032138293,0.07524999051468043,0.0827456770735321,0.09023298863449339,0.09771116383411974,0.1051794413089665,0.11263705969558911,0.12008325763054305,0.1275172737503837,0.1349383466916665,0.14234571509094676,0.14973861758478005,0.15711629280972167,0.16447797940232714,0.17182291599915184,0.1791503412367512,0.18645949375168053,0.19374961218049547,0.20101993515975114,0.20826970132600325,0.2154981493158071,0.22270451776571806,0.22988804531229162,0.23704797059208313,0.24418353224164815,0.25129396889754196,0.25837851919632004,0.2654364217745377,0.2724669152687505,0.2794692383155139,0.2864426295513831,0.2933863276129137,0.30029957113666106,0.3071815987591806,0.31403164911702786,0.3208489608467579,0.3276327725849266,0.3343823229680891,0.3410968506328009,0.3477755942156174,0.35441779235309395,0.3610226836817861,0.3675895068382492,0.37411750045903874,0.38060590318071,0.3870539536398184,0.3934608904729196,0.39982595231656876,0.40614837780732155,0.41242740558173313,0.4186622742763589,0.4248522225277545,0.43099648897247533,0.43709431224707673,0.44314493098811397,0.4491475838321426,0.45510150941571836,0.46100594637539605,0.4668601333477316,0.47266330896928016,0.4784147118765971,0.4841135807062383,0.48975915409475856,0.4953506706787137,0.5008873690946589,0.5063684879791497,0.5117932659687419,0.5171609416999902,0.5224707538094503,0.5277219409336777,0.5329137417092278,0.5380453947726563,0.5431161387605181,0.548125212309369,0.5530718540557641,0.5579553026362589,0.5627747966874093,0.5675295748457699,0.5722188757478968,0.5768419380303451,0.5813980003296704,0.585886301282428,0.5903060795251732,0.5946565736944616,0.5989370224268485,0.6031466643588893,0.6072847381271399,0.611350482368155,0.6153431357184903,0.6192619368147015,0.6231061242933436,0.6268749367909724,0.6305676129441429,0.6341833913894108,0.6377215107633315,0.6411812097024604,0.644561726843353,0.6478623008225644,0.6510821702766503,0.6542205738421661,0.6572767501556671,0.6602499378537089,0.6631393755728466,0.665944301949636,0.6686639556206324,0.6712975752223911,0.6738443993914676,0.6763036667644173,0.6786746159777957,0.680956485668158,0.6831485144720599,0.6852499410260566,0.6872600039667036,0.6891779419305563,0.6910029935541702,0.6927343974741006,0.694371392326903,0.6959132167491329,0.6973591093773456,0.6987083088480964,0.6999600537979409,0.7011135828634346,0.7021681346811327,0.7031229478875908,0.7039772611193642,0.7047303130130083,0.7053813422050785,0.7059295873321304,0.7063742870307194,0.7067146799374007,0.7069500046887299,0.7070794999212623,0.7071024042715536,0.7070179563761587,0.7068253948716334,0.7065239583945333,0.7061128855814133,0.7055914150688292,0.7049587854933362,0.7042142354914899,0.7033570036998456,0.7023863287549588,0.7013014492933849,0.7001016039516794,0.6987860313663974,0.6973539701740947,0.6958046590113264,0.6941373365146482,0.6923512413206153,0.6904456120657834,0.6884196873867074,0.6862727059199434,0.6840039063020462,0.6816125271695718,0.6790978071590752,0.6764589849071119,0.6736952990502372,0.6708059882250068,0.667790291067976,0.6646474462157002,0.6613766923047346,0.6579772679716351,0.6544484118529569,0.6507893625852552,0.6469993588050857,0.6430776391490038,0.6390234422535647,0.634836006755324,0.6305145712908371,0.6260583744966595,0.6214666550093464,0.6167386514654533,0.6118736025015357,0.606870746754149,0.6017293228598486,0.5964485694551899,0.5910277251767283,0.5854660286610192,0.5797627185446184,0.5739170334640806,0.5679282120559617,0.5617954929568171,0.555518114803202,0.5490953162316723,0.5425263358787829,0.5358104123810893,0.5289467843751471,0.5219346904975116,0.5147733693847384,0.5074620596733828,0.5],"type":"scatter","name":"y1","yaxis":"y","x":[0.0,0.01496193373117957,0.02969774251931864,0.0442085684095841,0.05849555344714279,0.0725598396771616,0.0864025691448074,0.10002488389524704,0.11342792597364744,0.12661283742517543,0.13958076029499789,0.15233283662828168,0.16487020847019368,0.17719401786590083,0.18930540686056987,0.20120551749936774,0.21289549182746131,0.22437647189001747,0.23564959973220312,0.24671601739918503,0.25757686693613013,0.2682332903882052,0.27868642980057734,0.28893742721841326,0.2989874246868798,0.30883756425114384,0.3184889879563724,0.3279428378477321,0.3372002559703901,0.34626238436951307,0.35513036509026785,0.3638053401778215,0.37228845167734076,0.3805808416339926,0.38868365209294375,0.3965980250993612,0.40432510269841165,0.41186602693526214,0.4192219398550796,0.4263939835030307,0.4333832999242825,0.4401910311640016,0.4468183192673551,0.45326630627951003,0.4595361342456328,0.46562894521089077,0.4715458812204504,0.4772880843194788,0.4828566965531428,0.48825285996660905,0.4934777166050448,0.4985324085136168,0.5034180777374918,0.5081358663218368,0.5126869163118183,0.5170723697526038,0.5212933686893597,0.5253510551672532,0.5292465712314509,0.5329810589271196,0.5365556602994265,0.5399715173935382,0.5432297722546218,0.546331566927844,0.5492780434583715,0.5520703438913719,0.554709610272011,0.5571969846454565,0.559533609056875,0.5617206255514332,0.5637591761742985,0.5656504029706372,0.5673954479856164,0.5689954532644029,0.5704515608521635,0.5717649127940656,0.5729366511352755,0.57396791792096,0.5748598551962866,0.5756136050064213,0.5762303093965321,0.5767111104117848,0.5770571500973467,0.5772695704983848,0.5773495136600656,0.5772981216275566,0.577116536446024,0.576805900160635,0.5763673548165564,0.5758020424589552,0.5751111051329982,0.5742956848838522,0.573356923756684,0.5722959637966606,0.5711139470489488,0.569812015558716,0.5683913113711281,0.5668529765313525,0.565198153084556,0.5634279830759057,0.5615436085505683,0.5595461715537107,0.5574368141304994,0.5552166783261018,0.5528869061856846,0.5504486397544146,0.5479030210774587,0.5452511921999837,0.5424942951671567,0.5396334720241444,0.5366698648161137,0.5336046155882314,0.5304388663856644,0.5271737592535796,0.5238104362371439,0.5203500393815242,0.5167937107318874,0.5131425923334001,0.5093978262312293,0.5055605544705422,0.5016319190965053,0.4976130621542856,0.4935051256890498,0.48930925174596496,0.485026582370198,0.4806582596069156,0.47620542550128486,0.4716692220984725,0.4670507914436453,0.4623512755819703,0.45757181655861434,0.45271355641874433,0.44777763720752695,0.4427652009701293,0.4376773897517181,0.4325153455974603,0.42728021055252274,0.4219731266620723,0.4165952359712758,0.41114768052530015,0.4056316023693122,0.40004814354847906,0.3943984461079672,0.38868365209294364,0.3829049035485754,0.3770633425200292,0.37116011105247204,0.36519635119107063,0.3591732049809919,0.35309181446740273,0.34695332169547005,0.34075886871036076,0.3345095975572416,0.3282066502812794,0.32185116892764115,0.31544429554149367,0.30898717216800403,0.3024809408523388,0.295926743639665,0.2893257225751494,0.28267901970395903,0.27598777707126076,0.2692531367222213,0.2624762407020076,0.2556582310557865,0.2488002498287249,0.24190343906598988,0.23496894081274794,0.22799789711416607,0.22099145001541126,0.21395074156165028,0.2068769137980502,0.19977110876977758,0.19263446852199945,0.1854681350998826,0.17827325054859403,0.17105095691330052,0.16380239623916917,0.15652871057136647,0.14923104195505948,0.14191053243541507,0.1345683240576001,0.12720555886678162,0.11982337890812617,0.11242292622680077,0.1050053428679723,0.09757177087680763,0.0901233522984738,0.08266122917813737,0.07518654356096537,0.06770043749212461,0.06020405301678203,0.052698532180104646,0.045185017027259,0.03766464960341212,0.03013857195373089,0.022607926123382176,0.015073854157533014,0.007537498101349943,0.0]},{"showlegend":true,"mode":"markers","xaxis":"x","colorbar":{"title":""},"marker":{"symbol":"circle","color":"rgba(227, 111, 71, 1.000)","line":{"color":"rgba(0, 0, 0, 1.000)","width":1},"size":8},"y":[0.0,0.5,1.0,0.5],"type":"scatter","name":"y2","yaxis":"y","x":[0.0,1.0,0.5,0.0]}], {"showlegend":true,"xaxis":{"gridwidth":0.5,"tickvals":[0.0,0.5,1.0],"ticks":"inside","tickmode":"array","domain":[0.05100612423447069,0.9934383202099737],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.0","0.5","1.0"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"y"},"paper_bgcolor":"rgba(255, 255, 255, 1.000)","annotations":[],"height":400,"margin":{"l":0,"b":20,"r":0,"t":20},"plot_bgcolor":"rgba(255, 255, 255, 1.000)","yaxis":{"gridwidth":0.5,"tickvals":[0.0,0.5,1.0],"ticks":"inside","tickmode":"array","domain":[0.03762029746281716,0.9901574803149606],"linecolor":"rgba(0, 0, 0, 1.000)","showgrid":true,"title":"","tickangle":0,"gridcolor":"rgba(0, 0, 0, 0.100)","titlefont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":15},"tickcolor":"rgba(0, 0, 0, 1.000)","ticktext":["0.0","0.5","1.0"],"zeroline":false,"type":"-","tickfont":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"anchor":"x"},"legend":{"bordercolor":"rgba(0, 0, 0, 1.000)","bgcolor":"rgba(255, 255, 255, 1.000)","font":{"color":"rgba(0, 0, 0, 1.000)","family":"sans-serif","size":11},"y":1.0,"x":1.0},"width":600});
    </script>

  </div>
</div>  

</body>
</html>
